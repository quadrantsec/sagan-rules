# Sagan aws-iam.rules
# Copyright (c) 2009-2023. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************

# rules by "Bryant Smith" <bsmith@quadrantsec.com>
# 10/20/2022

alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (AddClientIDToOpenIDConnectProvider) "; program:iam.amazonaws.com; json_content:".eventName","AddClientIDToOpenIDConnectProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008152; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (AddRoleToInstanceProfile) "; program:iam.amazonaws.com; json_content:".eventName","AddRoleToInstanceProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008153; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (AddUserToGroup) "; program:iam.amazonaws.com; json_content:".eventName","AddUserToGroup"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008154; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (AttachGroupPolicy) "; program:iam.amazonaws.com; json_content:".eventName","AttachGroupPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008155; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (AttachRolePolicy) "; program:iam.amazonaws.com; json_content:".eventName","AttachRolePolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008156; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (AttachUserPolicy) "; program:iam.amazonaws.com; json_content:".eventName","AttachUserPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008157; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ChangePassword) "; program:iam.amazonaws.com; json_content:".eventName","ChangePassword"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008158; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateAccessKey) "; program:iam.amazonaws.com; json_content:".eventName","CreateAccessKey"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008159; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateAccountAlias) "; program:iam.amazonaws.com; json_content:".eventName","CreateAccountAlias"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008160; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateGroup) "; program:iam.amazonaws.com; json_content:".eventName","CreateGroup"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008161; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateInstanceProfile) "; program:iam.amazonaws.com; json_content:".eventName","CreateInstanceProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008162; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateLoginProfile) "; program:iam.amazonaws.com; json_content:".eventName","CreateLoginProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008163; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateOpenIDConnectProvider) "; program:iam.amazonaws.com; json_content:".eventName","CreateOpenIDConnectProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008164; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreatePolicy) "; program:iam.amazonaws.com; json_content:".eventName","CreatePolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008165; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreatePolicyVersion) "; program:iam.amazonaws.com; json_content:".eventName","CreatePolicyVersion"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008166; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateRole) "; program:iam.amazonaws.com; json_content:".eventName","CreateRole"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008167; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateSAMLProvider) "; program:iam.amazonaws.com; json_content:".eventName","CreateSAMLProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008168; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateServiceLinkedRole) "; program:iam.amazonaws.com; json_content:".eventName","CreateServiceLinkedRole"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008169; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateServiceSpecificCredential) "; program:iam.amazonaws.com; json_content:".eventName","CreateServiceSpecificCredential"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008170; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateUser) "; program:iam.amazonaws.com; json_content:".eventName","CreateUser"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008171; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (CreateVirtualMFADevice) "; program:iam.amazonaws.com; json_content:".eventName","CreateVirtualMFADevice"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008172; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeactivateMFADevice) "; program:iam.amazonaws.com; json_content:".eventName","DeactivateMFADevice"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008173; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteAccessKey) "; program:iam.amazonaws.com; json_content:".eventName","DeleteAccessKey"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008174; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteAccountAlias) "; program:iam.amazonaws.com; json_content:".eventName","DeleteAccountAlias"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008175; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteAccountPasswordPolicy) "; program:iam.amazonaws.com; json_content:".eventName","DeleteAccountPasswordPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008176; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteGroup) "; program:iam.amazonaws.com; json_content:".eventName","DeleteGroup"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008177; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteGroupPolicy) "; program:iam.amazonaws.com; json_content:".eventName","DeleteGroupPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008178; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteInstanceProfile) "; program:iam.amazonaws.com; json_content:".eventName","DeleteInstanceProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008179; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteLoginProfile) "; program:iam.amazonaws.com; json_content:".eventName","DeleteLoginProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008180; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteOpenIDConnectProvider) "; program:iam.amazonaws.com; json_content:".eventName","DeleteOpenIDConnectProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008181; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeletePolicy) "; program:iam.amazonaws.com; json_content:".eventName","DeletePolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008182; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeletePolicyVersion) "; program:iam.amazonaws.com; json_content:".eventName","DeletePolicyVersion"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008183; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteRole) "; program:iam.amazonaws.com; json_content:".eventName","DeleteRole"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008184; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteRolePermissionsBoundary) "; program:iam.amazonaws.com; json_content:".eventName","DeleteRolePermissionsBoundary"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008185; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteRolePolicy) "; program:iam.amazonaws.com; json_content:".eventName","DeleteRolePolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008186; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteSAMLProvider) "; program:iam.amazonaws.com; json_content:".eventName","DeleteSAMLProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008187; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteServerCertificate) "; program:iam.amazonaws.com; json_content:".eventName","DeleteServerCertificate"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008188; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteServiceLinkedRole) "; program:iam.amazonaws.com; json_content:".eventName","DeleteServiceLinkedRole"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008189; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteServiceSpecificCredential) "; program:iam.amazonaws.com; json_content:".eventName","DeleteServiceSpecificCredential"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008190; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteSigningCertificate) "; program:iam.amazonaws.com; json_content:".eventName","DeleteSigningCertificate"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008191; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteSSHPublicKey) "; program:iam.amazonaws.com; json_content:".eventName","DeleteSSHPublicKey"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008192; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteUser) "; program:iam.amazonaws.com; json_content:".eventName","DeleteUser"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008193; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteUserPermissionsBoundary) "; program:iam.amazonaws.com; json_content:".eventName","DeleteUserPermissionsBoundary"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008194; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteUserPolicy) "; program:iam.amazonaws.com; json_content:".eventName","DeleteUserPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008195; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DeleteVirtualMFADevice) "; program:iam.amazonaws.com; json_content:".eventName","DeleteVirtualMFADevice"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008196; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DetachGroupPolicy) "; program:iam.amazonaws.com; json_content:".eventName","DetachGroupPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008197; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DetachRolePolicy) "; program:iam.amazonaws.com; json_content:".eventName","DetachRolePolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008198; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (DetachUserPolicy) "; program:iam.amazonaws.com; json_content:".eventName","DetachUserPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008199; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (EnableMFADevice) "; program:iam.amazonaws.com; json_content:".eventName","EnableMFADevice"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008200; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GenerateCredentialReport) "; program:iam.amazonaws.com; json_content:".eventName","GenerateCredentialReport"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008201; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GenerateOrganizationsAccessReport) "; program:iam.amazonaws.com; json_content:".eventName","GenerateOrganizationsAccessReport"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008202; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GenerateServiceLastAccessedDetails) "; program:iam.amazonaws.com; json_content:".eventName","GenerateServiceLastAccessedDetails"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008203; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetAccessKeyLastUsed) "; program:iam.amazonaws.com; json_content:".eventName","GetAccessKeyLastUsed"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008204; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetAccountAuthorizationDetails) "; program:iam.amazonaws.com; json_content:".eventName","GetAccountAuthorizationDetails"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008205; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetAccountPasswordPolicy) "; program:iam.amazonaws.com; json_content:".eventName","GetAccountPasswordPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008206; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetAccountSummary) "; program:iam.amazonaws.com; json_content:".eventName","GetAccountSummary"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008207; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetContextKeysForCustomPolicy) "; program:iam.amazonaws.com; json_content:".eventName","GetContextKeysForCustomPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008208; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetContextKeysForPrincipalPolicy) "; program:iam.amazonaws.com; json_content:".eventName","GetContextKeysForPrincipalPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008209; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetCredentialReport) "; program:iam.amazonaws.com; json_content:".eventName","GetCredentialReport"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008210; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetGroup) "; program:iam.amazonaws.com; json_content:".eventName","GetGroup"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008211; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetGroupPolicy) "; program:iam.amazonaws.com; json_content:".eventName","GetGroupPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008212; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetInstanceProfile) "; program:iam.amazonaws.com; json_content:".eventName","GetInstanceProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008213; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetLoginProfile) "; program:iam.amazonaws.com; json_content:".eventName","GetLoginProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008214; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetOpenIDConnectProvider) "; program:iam.amazonaws.com; json_content:".eventName","GetOpenIDConnectProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008215; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetOrganizationsAccessReport) "; program:iam.amazonaws.com; json_content:".eventName","GetOrganizationsAccessReport"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008216; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetPolicy) "; program:iam.amazonaws.com; json_content:".eventName","GetPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008217; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetPolicyVersion) "; program:iam.amazonaws.com; json_content:".eventName","GetPolicyVersion"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008218; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetRole) "; program:iam.amazonaws.com; json_content:".eventName","GetRole"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008219; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetRolePolicy) "; program:iam.amazonaws.com; json_content:".eventName","GetRolePolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008220; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetSAMLProvider) "; program:iam.amazonaws.com; json_content:".eventName","GetSAMLProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008221; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetServerCertificate) "; program:iam.amazonaws.com; json_content:".eventName","GetServerCertificate"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008222; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetServiceLastAccessedDetails) "; program:iam.amazonaws.com; json_content:".eventName","GetServiceLastAccessedDetails"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008223; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetServiceLastAccessedDetailsWithEntities) "; program:iam.amazonaws.com; json_content:".eventName","GetServiceLastAccessedDetailsWithEntities"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008224; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetServiceLinkedRoleDeletionStatus) "; program:iam.amazonaws.com; json_content:".eventName","GetServiceLinkedRoleDeletionStatus"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008225; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetSSHPublicKey) "; program:iam.amazonaws.com; json_content:".eventName","GetSSHPublicKey"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008226; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetUser) "; program:iam.amazonaws.com; json_content:".eventName","GetUser"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008227; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (GetUserPolicy) "; program:iam.amazonaws.com; json_content:".eventName","GetUserPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008228; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListAccessKeys) "; program:iam.amazonaws.com; json_content:".eventName","ListAccessKeys"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008229; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListAccountAliases) "; program:iam.amazonaws.com; json_content:".eventName","ListAccountAliases"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008230; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListAttachedGroupPolicies) "; program:iam.amazonaws.com; json_content:".eventName","ListAttachedGroupPolicies"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008231; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListAttachedRolePolicies) "; program:iam.amazonaws.com; json_content:".eventName","ListAttachedRolePolicies"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008232; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListAttachedUserPolicies) "; program:iam.amazonaws.com; json_content:".eventName","ListAttachedUserPolicies"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008233; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListEntitiesForPolicy) "; program:iam.amazonaws.com; json_content:".eventName","ListEntitiesForPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008234; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListGroupPolicies) "; program:iam.amazonaws.com; json_content:".eventName","ListGroupPolicies"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008235; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListGroups) "; program:iam.amazonaws.com; json_content:".eventName","ListGroups"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008236; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListGroupsForUser) "; program:iam.amazonaws.com; json_content:".eventName","ListGroupsForUser"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008237; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListInstanceProfiles) "; program:iam.amazonaws.com; json_content:".eventName","ListInstanceProfiles"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008238; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListInstanceProfilesForRole) "; program:iam.amazonaws.com; json_content:".eventName","ListInstanceProfilesForRole"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008239; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListInstanceProfileTags) "; program:iam.amazonaws.com; json_content:".eventName","ListInstanceProfileTags"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008240; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListMFADevices) "; program:iam.amazonaws.com; json_content:".eventName","ListMFADevices"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008241; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListMFADeviceTags) "; program:iam.amazonaws.com; json_content:".eventName","ListMFADeviceTags"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008242; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListOpenIDConnectProviders) "; program:iam.amazonaws.com; json_content:".eventName","ListOpenIDConnectProviders"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008243; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListOpenIDConnectProviderTags) "; program:iam.amazonaws.com; json_content:".eventName","ListOpenIDConnectProviderTags"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008244; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListPolicies) "; program:iam.amazonaws.com; json_content:".eventName","ListPolicies"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008245; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListPoliciesGrantingServiceAccess) "; program:iam.amazonaws.com; json_content:".eventName","ListPoliciesGrantingServiceAccess"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008246; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListPolicyTags) "; program:iam.amazonaws.com; json_content:".eventName","ListPolicyTags"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008247; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListPolicyVersions) "; program:iam.amazonaws.com; json_content:".eventName","ListPolicyVersions"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008248; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListRolePolicies) "; program:iam.amazonaws.com; json_content:".eventName","ListRolePolicies"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008249; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListRoles) "; program:iam.amazonaws.com; json_content:".eventName","ListRoles"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008250; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListRoleTags) "; program:iam.amazonaws.com; json_content:".eventName","ListRoleTags"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008251; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListSAMLProviders) "; program:iam.amazonaws.com; json_content:".eventName","ListSAMLProviders"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008252; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListSAMLProviderTags) "; program:iam.amazonaws.com; json_content:".eventName","ListSAMLProviderTags"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008253; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListServerCertificates) "; program:iam.amazonaws.com; json_content:".eventName","ListServerCertificates"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008254; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListServerCertificateTags) "; program:iam.amazonaws.com; json_content:".eventName","ListServerCertificateTags"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008255; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListServiceSpecificCredentials) "; program:iam.amazonaws.com; json_content:".eventName","ListServiceSpecificCredentials"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008256; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListSigningCertificates) "; program:iam.amazonaws.com; json_content:".eventName","ListSigningCertificates"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008257; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListSSHPublicKeys) "; program:iam.amazonaws.com; json_content:".eventName","ListSSHPublicKeys"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008258; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListUserPolicies) "; program:iam.amazonaws.com; json_content:".eventName","ListUserPolicies"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008259; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListUsers) "; program:iam.amazonaws.com; json_content:".eventName","ListUsers"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008260; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListUserTags) "; program:iam.amazonaws.com; json_content:".eventName","ListUserTags"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008261; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ListVirtualMFADevices) "; program:iam.amazonaws.com; json_content:".eventName","ListVirtualMFADevices"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008262; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (PutGroupPolicy) "; program:iam.amazonaws.com; json_content:".eventName","PutGroupPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008263; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (PutRolePermissionsBoundary) "; program:iam.amazonaws.com; json_content:".eventName","PutRolePermissionsBoundary"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008264; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (PutRolePolicy) "; program:iam.amazonaws.com; json_content:".eventName","PutRolePolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008265; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (PutUserPermissionsBoundary) "; program:iam.amazonaws.com; json_content:".eventName","PutUserPermissionsBoundary"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008266; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (PutUserPolicy) "; program:iam.amazonaws.com; json_content:".eventName","PutUserPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008267; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (RemoveClientIDFromOpenIDConnectProvider) "; program:iam.amazonaws.com; json_content:".eventName","RemoveClientIDFromOpenIDConnectProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008268; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (RemoveRoleFromInstanceProfile) "; program:iam.amazonaws.com; json_content:".eventName","RemoveRoleFromInstanceProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008269; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (RemoveUserFromGroup) "; program:iam.amazonaws.com; json_content:".eventName","RemoveUserFromGroup"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008270; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ResetServiceSpecificCredential) "; program:iam.amazonaws.com; json_content:".eventName","ResetServiceSpecificCredential"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008271; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (ResyncMFADevice) "; program:iam.amazonaws.com; json_content:".eventName","ResyncMFADevice"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008272; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (SetDefaultPolicyVersion) "; program:iam.amazonaws.com; json_content:".eventName","SetDefaultPolicyVersion"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008273; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (SetSecurityTokenServicePreferences) "; program:iam.amazonaws.com; json_content:".eventName","SetSecurityTokenServicePreferences"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008274; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (SimulateCustomPolicy) "; program:iam.amazonaws.com; json_content:".eventName","SimulateCustomPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008275; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (SimulatePrincipalPolicy) "; program:iam.amazonaws.com; json_content:".eventName","SimulatePrincipalPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008276; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (TagInstanceProfile) "; program:iam.amazonaws.com; json_content:".eventName","TagInstanceProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008277; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (TagMFADevice) "; program:iam.amazonaws.com; json_content:".eventName","TagMFADevice"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008278; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (TagOpenIDConnectProvider) "; program:iam.amazonaws.com; json_content:".eventName","TagOpenIDConnectProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008279; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (TagPolicy) "; program:iam.amazonaws.com; json_content:".eventName","TagPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008280; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (TagRole) "; program:iam.amazonaws.com; json_content:".eventName","TagRole"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008281; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (TagSAMLProvider) "; program:iam.amazonaws.com; json_content:".eventName","TagSAMLProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008282; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (TagServerCertificate) "; program:iam.amazonaws.com; json_content:".eventName","TagServerCertificate"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008283; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (TagUser) "; program:iam.amazonaws.com; json_content:".eventName","TagUser"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008284; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UntagInstanceProfile) "; program:iam.amazonaws.com; json_content:".eventName","UntagInstanceProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008285; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UntagMFADevice) "; program:iam.amazonaws.com; json_content:".eventName","UntagMFADevice"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008286; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UntagOpenIDConnectProvider) "; program:iam.amazonaws.com; json_content:".eventName","UntagOpenIDConnectProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008287; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UntagPolicy) "; program:iam.amazonaws.com; json_content:".eventName","UntagPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008288; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UntagRole) "; program:iam.amazonaws.com; json_content:".eventName","UntagRole"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008289; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UntagSAMLProvider) "; program:iam.amazonaws.com; json_content:".eventName","UntagSAMLProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008290; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UntagServerCertificate) "; program:iam.amazonaws.com; json_content:".eventName","UntagServerCertificate"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008291; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UntagUser) "; program:iam.amazonaws.com; json_content:".eventName","UntagUser"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008292; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateAccessKey) "; program:iam.amazonaws.com; json_content:".eventName","UpdateAccessKey"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008293; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateAccountPasswordPolicy) "; program:iam.amazonaws.com; json_content:".eventName","UpdateAccountPasswordPolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008294; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateAssumeRolePolicy) "; program:iam.amazonaws.com; json_content:".eventName","UpdateAssumeRolePolicy"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008295; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateGroup) "; program:iam.amazonaws.com; json_content:".eventName","UpdateGroup"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008296; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateLoginProfile) "; program:iam.amazonaws.com; json_content:".eventName","UpdateLoginProfile"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008297; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateOpenIDConnectProviderThumbprint) "; program:iam.amazonaws.com; json_content:".eventName","UpdateOpenIDConnectProviderThumbprint"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008298; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateRole) "; program:iam.amazonaws.com; json_content:".eventName","UpdateRole"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008299; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateRoleDescription) "; program:iam.amazonaws.com; json_content:".eventName","UpdateRoleDescription"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008300; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateSAMLProvider) "; program:iam.amazonaws.com; json_content:".eventName","UpdateSAMLProvider"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008301; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateServerCertificate) "; program:iam.amazonaws.com; json_content:".eventName","UpdateServerCertificate"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008302; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateServiceSpecificCredential) "; program:iam.amazonaws.com; json_content:".eventName","UpdateServiceSpecificCredential"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008303; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateSigningCertificate) "; program:iam.amazonaws.com; json_content:".eventName","UpdateSigningCertificate"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008304; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateSSHPublicKey) "; program:iam.amazonaws.com; json_content:".eventName","UpdateSSHPublicKey"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008305; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UpdateUser) "; program:iam.amazonaws.com; json_content:".eventName","UpdateUser"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008306; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UploadServerCertificate) "; program:iam.amazonaws.com; json_content:".eventName","UploadServerCertificate"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008307; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UploadSigningCertificate) "; program:iam.amazonaws.com; json_content:".eventName","UploadSigningCertificate"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008308; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management event detected (UploadSSHPublicKey) "; program:iam.amazonaws.com; json_content:".eventName","UploadSSHPublicKey"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5008309; rev:1;)

#rules added 31 Oct 2023 BS
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] AWS Root account being used"; program:iam.amazonaws.com; json_content:".userIdentity.type","Root"; json_nocase; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/sdk-for-ruby/v2/api/Aws/Macie2/Types/UserIdentity.html; sid:5014020; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-SIGNIN] AWS IAMUser Login Failures - Brute Force 25/1"; program:signin.amazonaws.com; json_content:".eventName","ConsoleLogin"; json_content:".responseElements.ConsoleLogin","Failure"; parse_src_ip:1; classtype:unsuccessful-user; after: track by_src, count 25, seconds 300; threshold: type suppress, track by_src, count 1, seconds 86400; reference:url,aws.amazon.com/blogs/mt/analyzing-cloudtrail-in-cloudwatch/; sid:5014021; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-SIGNIN] Successful User login without MFA"; program:signin.amazonaws.com; json_content:".eventName","ConsoleLogin"; json_content:".additionalEventData.MFAUsed","No"; json_content:".responseElements.ConsoleLogin","Success"; parse_src_ip:1; classtype:system-event; reference:url,aws.amazon.com/blogs/mt/analyzing-cloudtrail-in-cloudwatch/; sid:5014022; rev:2;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-SIGNIN] MFA Device Deactivated"; program:iam.amazonaws.com; json_content:".eventName","DeactivateMFADevice"; parse_src_ip:1; classtype:system-event; reference:url,aws.amazon.com/blogs/mt/analyzing-cloudtrail-in-cloudwatch/; sid:5014023; rev:1;)

alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management Discovery Command Event Detected (ListUsers)"; program:iam.amazonaws.com; content:"eventName|22 3a 20 22|ListUsers"; parse_src_ip: 1; classtype:system-event; reference:url,docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html; sid:5015086; rev:1; metadata:mitre_tactic_id TA0007;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management Privilege Escalation Event Detected (CreateRole)"; program:iam.amazonaws.com; content:"eventName|22 3a 20 22|CreateRole"; parse_src_ip: 1; classtype:system-event; reference:url,https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/; sid:5015092; rev:1; metadata:mitre_tactic_id TA0004;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-IAM] Identity and Access Management Administrator Access Assigned to Role - Privilege Escalation"; program:*.amazonaws.com; meta_content:"eventName|22 3a 20 22|%sagan%,AttachRolePolicy,PutBucketPolicy"; content:"|22|Effect|22 3a 22|Allow|22|"; content:"|22|Action|22 3a 22|*|22|"; content:"|22|Resource|22 3a 22|*|22|"; parse_src_ip: 1; classtype:system-event; reference:url,https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/; reference:url,https://docs.aws.amazon.com/aws-managed-policy/latest/reference/AdministratorAccess.html; sid:5015093; rev:1; metadata:mitre_tactic_id TA0004;)
