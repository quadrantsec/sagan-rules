# Sagan darktrace.rules
# Copyright (c) 2009-2021. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************

# Darktrace signatures by Justin Kling ( jkling _AT_ quadrantsec.com )

alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious traffic detection"; program: darktrace; meta_content: !"%sagan%|3a 3a|",Anomalous Connection,Anomalous File,Anomalous Server Activity,Antigena,Compliance,Compromise,Device,Infrastructure,System,Unusual Activity,User; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005840; sid:5005840; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious Anomalous Connection Alert"; program: darktrace; content: "Anomalous Connection|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005841; sid:5005841; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious Anomalous File Alert"; program: darktrace; content: "Anomalous File|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005842; sid:5005842; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious Anomalous Server Activity Alert"; program: darktrace; content: "Anomalous Server Activity|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005843; sid:5005843; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious Antigena Alert"; program: darktrace; content: "Antigena|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005844; sid:5005844; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious Compliance Alert"; program: darktrace; content: "Compliance|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005845; sid:5005845; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious Compromise Alert"; program: darktrace; content: "Compromise|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005846; sid:5005846; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious Device Alert"; program: darktrace; content: "Device|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005847; sid:5005847; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious Infrastructure Alert"; program: darktrace; content: "Infrastructure|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005848; sid:5005848; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious System Alert"; program: darktrace; content: "System|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005849; sid:5005849; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious Unusual Activity Alert"; program: darktrace; content: "Unusual Activity|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005850; sid:5005850; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious User Alert"; program: darktrace; content: "User|3a 3a|"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005851; sid:5005851; rev:1;)


alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Potential Malicious Remote Desktop Tunnel"; program: darktrace; content: "Anomalous Connection"; content: "Active Remote Desktop Tunnel"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005852; sid:5005852; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] External connection from a device over an uncommon port"; program: darktrace; content: "Anomalous Connection"; content: "Application Protocol on Uncommon Port"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005853; sid:5005853; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is sending a large volume of data to an external location"; program: darktrace; content: "Anomalous Connection"; content: "Data Sent to Rare Domain"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005854; sid:5005854; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is making an outbound VPN connection to a rare external location"; program: darktrace; content: "Anomalous Connection"; content: "IPSec VPN to Rare IP"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005855; sid:5005855; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Device is connecting to new external deviecs not detected before"; program: darktrace; content: "Anomalous Connection"; content: "Lots of New Connections"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005856; sid:5005856; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has transfered a modearate to large volume of traffic over a 24 hour period"; program: darktrace; content: "Anomalous Connection"; content: "Low and Slow Exfiltration to IP"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005857; sid:5005857; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has begun communicating on a UDP port it has never used before"; program: darktrace; content: "Anomalous Connection"; content: "Multiple Connections to New External UDP Port"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005858; sid:5005858; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is posting data out out of the network to a rare external hostname"; program: darktrace; content: "Anomalous Connection"; content: "Multiple HTTP POSTs to Rare Hostname"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005859; sid:5005859; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is connecting directly to an IP address without a hostname using a new user agent"; program: darktrace; content: "Anomalous Connection"; content: "New User Agent to IP Without Hostname"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005860; sid:5005860; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Suspicious charcters found in hostanme of external connection"; program: darktrace; content: "Anomalous Connection"; content: "Possible IDN Homograph Attack"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005861; sid:5005861; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is posting data out out of the network to a rare external location without a hostname"; program: darktrace; content: "Anomalous Connection"; content: "Posting HTTP to IP Without Hostname"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005862; sid:5005862; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is communicating with a server using a self signed certificate"; program: darktrace; content: "Anomalous Connection"; content: "Rare External SSL Self-Signed"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005863; sid:5005863; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is communicating with a server using an expired certificate"; program: darktrace; content: "Anomalous Connection"; content: "Suspicious Expired SSL"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005864; sid:5005864; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is communicating with a server using a suspicious self signed certificate"; program: darktrace; content: "Anomalous Connection"; content: "Suspicious Self-Signed SSL"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005865; sid:5005865; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A highly privileged credential is being used to connect between two devices that rarely interact"; program: darktrace; content: "Anomalous Connection"; content: "Unusual Admin RDP Session"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005866; sid:5005866; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is transferring an abnormally large volume of data internally"; program: darktrace; content: "Anomalous Connection"; content: "Unusual Incoming Data Volume"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005867; sid:5005867; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is making an unusual outgoing Remote Desktop connection"; program: darktrace; content: "Anomalous Connection"; content: "Unusual Internal Remote Desktop"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005868; sid:5005868; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device downloaded a file from an uncommon external location"; program: darktrace; content: "Anomalous File"; content: "Anomalous Octet Stream"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005869; sid:5005869; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has downloaded an executable from a location that the network does not normally visit"; program: darktrace; content: "Anomalous File"; content: "Apple Application from Rare External Location"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005870; sid:5005870; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has downloaded a Windows Portable Executable (PE) via unencrypted FTP"; program: darktrace; content: "Anomalous File"; content: "FTP Executable from Rare External Location"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005871; sid:5005871; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has written a script file to another internal device it has not connected to in this way before"; program: darktrace; content: "Anomalous File"; content: "Internal"; content: "Unusual SMB Script Write"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005872; sid:5005872; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has downloaded a ZIP file from a location that the network does not normally visit"; program: darktrace; content: "Anomalous File"; content: "Zip or Gzip from Rare External Location"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005873; sid:5005873; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A server is making unusual external connections to destinations not frequently visited by devices on the network"; program: darktrace; content: "Anomalous Server Activity"; content: "Outgoing from Server"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005874; sid:5005874; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has begun serving protocols to a rare external endpoint, on an unusual port"; program: darktrace; content: "Anomalous Server Activity"; content: "Server Activity on New Non-Standard Port"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005875; sid:5005875; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is communicating with the Tor network privacy service"; program: darktrace; content: "Antigena"; content: "Network"; content: "Compliance"; content: "Antigena Tor Block"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005876; sid:5005876; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is making anomalous internal file transfers"; program: darktrace; content: "Antigena"; content: "Network"; content: "Insider Threat"; content: "Antigena Internal Anomalous File Activity"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005877; sid:5005877; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is persistently causing unexpected event"; program: darktrace; content: "Antigena"; content: "Network"; content: "Significant Anomaly"; content: "Antigena Breaches Over Time Block"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005878; sid:5005878; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is making peer-to-peer BitTorrent connections"; program: darktrace; content: "Compliance"; content: "BitTorrent"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005879; sid:5005879; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is communicating externally with a rare location using ports normally only used within the internal network"; program: darktrace; content: "Compliance"; content: "External Windows Communications"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005880; sid:5005880; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is being remotely controlled from outside the network"; program: darktrace; content: "Compliance"; content: "Incoming Remote Desktop"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005881; sid:5005881; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has been observed receiving a number of SIP requests from a rare external endpoint"; program: darktrace; content: "Compliance"; content: "Multiple SIP Requests From Rare"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005882; sid:5005882; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has made an external encrypted connection to a rare endpoint on a port associated with DoT"; program: darktrace; content: "Compliance"; content: "Possible DNS Over HTTPS/TLS"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005883; sid:5005883; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device was observed accessing a document over SMB that appears to contain sensitive information"; program: darktrace; content: "Compliance"; content: "Possible Unencrypted Password File On Server"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005884; sid:5005884; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A server is detected storing sensitive files in SMB connections"; program: darktrace; content: "Compliance"; content: "Sensitive Terms in New or Unusual SMB Connection"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005885; sid:5005885; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is making SSH connections to rare external destinations"; program: darktrace; content: "Compliance"; content: "SSH to Rare External Destination"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005886; sid:5005886; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is initiating multiple connections to a rare external endpoint in a regular manner"; program: darktrace; content: "Compromise"; content: "Agent Beacon"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005887; sid:5005887; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has been repeatedly connecting to a rare external location - possible beaconing"; program: darktrace; content: "Compromise"; content: "Beaconing Activity To External Rare"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005888; sid:5005888; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Possible beaconing to an rare external algorithmically generated endpoint"; program: darktrace; content: "Compromise"; content: "DGA Beacon"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005889; sid:5005889; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Possible beaconing to a rare external location"; program: darktrace; content: "Compromise"; content: "High Volume of Connections with Beacon Score"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005890; sid:5005890; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] Possible presistent connection to a rare external host"; program: darktrace; content: "Compromise"; content: "Repeating Connections Over 4 Days"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005891; sid:5005891; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is causing repeated spikes in HTTP or SSL connections to new external location for over a day"; program: darktrace; content: "Compromise"; meta_content: "%sagan%", Sustained SSL or HTTP Increase,SSL or HTTP Beacon ; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005892; sid:5005892; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has made a large number of NTLM login failures"; program: darktrace; content: "Device"; content: "Anomalous NTLM Bruteforce"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005893; sid:5005893; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is using common penetration testing tools"; program: darktrace; content: "Device"; content: "Attack and Recon Tools"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005894; sid:5005894; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A number of devices have been detected reading a suspicious executable file from an internal server"; program: darktrace; content: "Device"; content: "EXE Files Distributed to Multiple Devices"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005895; sid:5005895; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has initiated a large number of connections to unique, rare endpoints"; program: darktrace; content: "Device"; content: "Large Number of Connections to New Endpoints"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005896; sid:5005896; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has made a long SSL connection to a new endpoint, with an unusual SSL client"; program: darktrace; content: "Device"; content: "Long Agent Connection to New Endpoint"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005897; sid:5005897; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is making new internal connections to a range of internal hosts consistent with network scanning"; program: darktrace; content: "Device"; content: "Network Scan - Low Anomaly Score"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005898; sid:5005898; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is making HTTP or HTTPS connections to new IP immediately following a new User-Agent"; program: darktrace; content: "Device"; content: "New User Agent and New IP"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005899; sid:5005899; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device performed an unusual connection to a domain controller using SAMR and subsequently downloaded an unusual volume of data via LDAP"; program: darktrace; content: "Device"; content: "Possible Active Directory Enumeration"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005900; sid:5005900; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is making reverse DNS lookups for a range of internal hosts consistent with network reconnaissance"; program: darktrace; content: "Device"; content: "Reverse DNS Sweep"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005901; sid:5005901; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device was detected making an SMB query for a known sensitive file"; program: darktrace; content: "Device"; content: "Suspicious SMB Query"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005902; sid:5005902; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is requesting DNS from a rare external location"; program: darktrace; content: "Device"; content: "Unusual External DNS"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005903; sid:5005903; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A new proxy server has been detected, or an existing server has stopped"; program: darktrace; content: "Infrastructure"; content: "Proxy Server Change"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005904; sid:5005904; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is both receiving and making an SSH connection simultaneously creating a potential tunnel"; program: darktrace; content: "System"; content: "Internal Domain Name Change"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005905; sid:5005905; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has deleted an anomalous volume of files from a network share"; program: darktrace; content: "Unusual Activity"; content: "Anomalous SMB Delete Volume"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005906; sid:5005906; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is sending an abnormally high level of data externally"; content: "Unusual Activity"; program: darktrace; meta_content: "%sagan%",Enhanced Unusual External Data Transfer,Unusual File Storage Data Transfer; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005907; sid:5005907; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device is transferring an abnormally large volume of data internally"; content: "Unusual Activity"; program: darktrace; content: "Internal Data Transfer"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005908; sid:5005908; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has made a large number of attempts to access files on a network share that it is not authorised to access"; program: darktrace; content: "Unusual Activity"; content: "SMB Access Failures"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005909; sid:5005909; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device that has not been seen on the network for an extended time is now active and deviating from normal network behaviour"; program: darktrace; content: "Unusual Activity"; content: "Unusual Activity from Re-Activated Device"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005910; sid:5005910; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A device has made a large volume of Kerberos logon failures using the same credential"; program: darktrace; content: "User"; content: "Kerberos Password Bruteforce"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005911; sid:5005911; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DARKTRACE] A highly privileged credential is being used for the first time on a client device"; program: darktrace; content: "User"; content: "New Admin Credentials on Client"; parse_src_ip: 1; xbits: set,exploit_attempt,track ip_src; classtype: bad-unknown; reference: url,wiki.quadrantsec.com/bin/view/Main/5005912; sid:5005912; rev:1;)
