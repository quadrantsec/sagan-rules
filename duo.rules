# Sagan duo.rules
# Copyright (c) 2009-2023. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************

# rules by "Bryant Smith" <bsmith@quadrantsec.com>
# 10/31/2023

alert any $HOME_NET any -> $EXTERNAL_NET any (msg: "[DUO] Authentication - Brute Force"; content: "event_type|22 3A 20 22|authentication"; content: "result|22 3A 20 22|denied"; parse_src_ip:1; after:track by_src, count 4, seconds 300; threshold: type suppress, track by_src, count 1, seconds 86400; classtype: attempted-user; program: duo; sid:5006528; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg: "[DUO] User Placed in Bypass"; content: "user_update"; content: "Bypass"; classtype: system-event; program: duo; sid: 5010333; rev: 1)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] device activation process started"; program:duo; json_content:".eventtype","administrator"; json_content:".action","activation_begin"; classtype:system-event; reference:url,help.duo.com; sid:5013944; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] device activation process completed"; program:duo; json_content:".eventtype","administrator"; json_content:".action","activation_complete"; classtype:system-event; reference:url,help.duo.com; sid:5013945; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] email sent for device activation"; program:duo; json_content:".eventtype","administrator"; json_content:".action","activation_send_email"; classtype:system-event; reference:url,help.duo.com; sid:5013946; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] device activation password set"; program:duo; json_content:".eventtype","administrator"; json_content:".action","activation_set_password"; classtype:system-event; reference:url,help.duo.com; sid:5013947; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] 2FA admin login error"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_2fa_error"; parse_src_ip: 1; classtype:system-event; reference:url,help.duo.com; sid:5013948; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin activated device for duo push"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_activate_duo_push"; classtype:system-event; reference:url,help.duo.com; sid:5013949; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin api IP access request denied "; program:duo; json_content:".eventtype","administrator"; json_content:".action","adminapi_request_ip_denied"; classtype:system-event; reference:url,https://duo.com/docs/adminapi; reference:url,help.duo.com; sid:5013950; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin created an object"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_create"; classtype:system-event; reference:url,help.duo.com; sid:5013951; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin deleted an object"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_delete"; classtype:system-event; reference:url,help.duo.com; sid:5013952; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin account locked due to too many password/passcode attempts"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_lockout"; classtype:system-event; reference:url,help.duo.com; sid:5013953; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] successful admin login"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_login"; classtype:system-event; reference:url,help.duo.com; sid:5013954; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin login attempt error"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_login_error"; content:!"Invalid password attempt"; classtype:system-event; reference:url,help.duo.com; sid:5013955; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin login error due to invalid password attempts [10/1]"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_login_error"; content:"Invalid password attempt"; after:track by_src, count 10,seconds 300; threshold:type suppress,track by_src, count 1, seconds 3600; xbits: isset,brute_force,track ip_src; classtype:system-event; reference:url,help.duo.com; sid:5013956; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin reactivated duo device"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_reactivates_duo_push"; classtype:system-event; reference:url,help.duo.com; sid:5013957; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin password reset"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_reset_password"; classtype:system-event; reference:url,help.duo.com; sid:5013958; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin self activated device"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_self_activate"; classtype:system-event; reference:url,help.duo.com; sid:5013959; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin email sent for password reset"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_send_reset_password_email"; classtype:system-event; reference:url,help.duo.com; sid:5013960; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin updated an object"; program:duo; json_content:".eventtype","administrator"; json_content:".action","admin_update"; classtype:system-event; reference:url,help.duo.com; sid:5013961; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] azure active directory group updated"; program:duo; json_content:".eventtype","administrator"; json_content:".action","azure_directory_groups_update"; classtype:system-event; reference:url,help.duo.com; sid:5013962; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] azure directory object updated"; program:duo; json_content:".eventtype","administrator"; json_content:".action","azure_directory_update"; classtype:system-event; reference:url,help.duo.com; sid:5013963; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] azure sync started"; program:duo; json_content:".eventtype","administrator"; json_content:".action","azure_sync_begin"; classtype:system-event; reference:url,help.duo.com; sid:5013964; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] azure user sync started"; program:duo; json_content:".eventtype","administrator"; json_content:".action","azure_sync_by_user_begin"; classtype:system-event; reference:url,help.duo.com; sid:5013965; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] azure user sync finished"; program:duo; json_content:".eventtype","administrator"; json_content:".action","azure_sync_by_user_finish"; classtype:system-event; reference:url,help.duo.com; sid:5013966; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] azure sync finished"; program:duo; json_content:".eventtype","administrator"; json_content:".action","azure_sync_finish"; classtype:system-event; reference:url,help.duo.com; sid:5013967; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] bypass code created for user"; program:duo; json_content:".eventtype","administrator"; json_content:".action","bypass_create"; classtype:system-event; reference:url,help.duo.com; sid:5013968; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] bypass code deleted for user"; program:duo; json_content:".eventtype","administrator"; json_content:".action","bypass_delete"; classtype:system-event; reference:url,help.duo.com; sid:5013969; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin bypass view created"; program:duo; json_content:".eventtype","administrator"; json_content:".action","bypass_view"; classtype:system-event; reference:url,help.duo.com; sid:5013970; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin updated customer data"; program:duo; json_content:".eventtype","administrator"; json_content:".action","customer_update"; classtype:system-event; reference:url,help.duo.com; sid:5013971; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin created integration"; program:duo; json_content:".eventtype","administrator"; json_content:".action","integration_create"; classtype:system-event; reference:url,help.duo.com; sid:5013972; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin deleted integration"; program:duo; json_content:".eventtype","administrator"; json_content:".action","integration_delete"; classtype:system-event; reference:url,help.duo.com; sid:5013973; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin integration group policy added"; program:duo; json_content:".eventtype","administrator"; json_content:".action","integration_group_policy_add"; classtype:system-event; reference:url,help.duo.com; sid:5013974; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin integration group policy removed"; program:duo; json_content:".eventtype","administrator"; json_content:".action","integration_group_policy_remove"; classtype:system-event; reference:url,help.duo.com; sid:5013975; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin integration policy assigned"; program:duo; json_content:".eventtype","administrator"; json_content:".action","integration_policy_assign"; classtype:system-event; reference:url,help.duo.com; sid:5013976; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin integration skey view created"; program:duo; json_content:".eventtype","administrator"; json_content:".action","integration_skey_view"; classtype:system-event; reference:url,help.duo.com; sid:5013977; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin updated integration data"; program:duo; json_content:".eventtype","administrator"; json_content:".action","integration_update"; classtype:system-event; reference:url,help.duo.com; sid:5013978; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] new phone created by admin"; program:duo; json_content:".eventtype","administrator"; json_content:".action","phone_create"; classtype:system-event; reference:url,help.duo.com; sid:5013979; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin deleted phone data"; program:duo; json_content:".eventtype","administrator"; json_content:".action","phone_delete"; classtype:system-event; reference:url,help.duo.com; sid:5013980; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin updated phone data"; program:duo; json_content:".eventtype","administrator"; json_content:".action","phone_update"; classtype:system-event; reference:url,help.duo.com; sid:5013981; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin created new policy"; program:duo; json_content:".eventtype","administrator"; json_content:".action","policy_create"; classtype:system-event; reference:url,help.duo.com; sid:5013982; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin updated policy"; program:duo; json_content:".eventtype","administrator"; json_content:".action","policy_update"; classtype:system-event; reference:url,help.duo.com; sid:5013983; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin push verification approved"; program:duo; json_content:".eventtype","administrator"; json_content:".action","push_verify_approved"; classtype:system-event; reference:url,help.duo.com; sid:5013984; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin push verification failed"; program:duo; json_content:".eventtype","administrator"; json_content:".action","push_verify_failed"; classtype:system-event; reference:url,help.duo.com; sid:5013985; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin authentication attempts were reset"; program:duo; json_content:".eventtype","administrator"; json_content:".action","reset_admin_auth_attempts"; classtype:system-event; reference:url,help.duo.com; sid:5013986; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin sent enrollment code"; program:duo; json_content:".eventtype","administrator"; json_content:".action","send_enroll_code"; classtype:system-event; reference:url,help.duo.com; sid:5013987; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin created a new user"; program:duo; json_content:".eventtype","administrator"; json_content:".action","user_create"; classtype:system-event; reference:url,help.duo.com; sid:5013988; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin deleted a user"; program:duo; json_content:".eventtype","administrator"; json_content:".action","user_delete"; classtype:system-event; reference:url,help.duo.com; sid:5013989; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin user delete pending"; program:duo; json_content:".eventtype","administrator"; json_content:".action","user_pending_delete"; classtype:system-event; reference:url,help.duo.com; sid:5013990; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin restored user account"; program:duo; json_content:".eventtype","administrator"; json_content:".action","user_restore"; classtype:system-event; reference:url,help.duo.com; sid:5013991; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin updated user account"; program:duo; json_content:".eventtype","administrator"; json_content:".action","user_update"; classtype:system-event; reference:url,help.duo.com; sid:5013992; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] admin created web authentication credentials"; program:duo; json_content:".eventtype","administrator"; json_content:".action","webauthncredential_create"; classtype:system-event; reference:url,help.duo.com; sid:5013993; rev:1;)

#Telephony
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] administrator login via phone"; program:duo; json_content:".eventtype","telephony"; json_content:".type","phone"; json_content:".context","administrator login"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5013994; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] administrator login via sms"; program:duo; json_content:".eventtype","telephony"; json_content:".type","sms"; json_content:".context","administrator login"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5013995; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user login via phone"; program:duo; json_content:".eventtype","telephony"; json_content:".type","phone"; json_content:".context","authentication"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5013996; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user login via sms"; program:duo; json_content:".eventtype","telephony"; json_content:".type","sms"; json_content:".context","authentication"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5013997; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user enrollment via sms"; program:duo; json_content:".eventtype","telephony"; json_content:".type","sms"; json_content:".context","enrollment"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5013998; rev:1;)

#Authentication
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user successful authentication via policy"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","allowed_by_policy"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5013999; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user failed authentication from anomalous push"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","anomalous_push"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014000; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user successful authentication via bypass"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","bypass_user"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014001; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication failed due to call timeout"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","call_timed_out"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014002; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication failed due to unenrolled user"; program:duo; parse_src_ip: 1; json_content:".eventtype","authentication"; json_content:".reason","deny_unenrolled_user"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014003; rev:2;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication failed due to error"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","error"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014004; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication failed due to an invalid device"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","invalid_device"; json_map: "src_ip", ".access_device.ip"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014005; metadata: updated_on 2024_05_03; rev:2;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication failed for multiple invalid passcodes [5/1]"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","invalid_passcode"; after:track by_src,count 5, seconds 60; threshold:type suppress, track by_src,count 1, seconds 3600; parse_src_ip:1; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014006; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] Authentication Failed Due to Account Lock Out"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","locked_out"; json_map: "src_ip", ".access_device.ip"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; reference:url,help.duo.com/s/article/4963?language=en_US; sid:5014007; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication failed due to no keys pressed"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","no_keys_pressed"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014008; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication failed from no response"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","no_response"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014009; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication successful from remembered device"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","remembered_device"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014010; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication successful from trusted network"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","trusted_network"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014011; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication success from user approval"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","user_approved"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014012; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication failed from cancelled request"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","user_cancelled"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014013; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication failed due to account disabled"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","user_disabled"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014014; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user marked login attempt as fraud"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","user_marked_fraud"; classtype:system-event; parse_src_ip: 1; reference:url,duo.com/docs/risk-based-auth; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014015; rev:2;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication failed due to user mistake"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","user_mistake"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014016; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication successful from valid passcode"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","valid_passcode"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014017; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication verification code correct"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","verification_code_correct"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014018; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] user authentication verification code missing"; program:duo; json_content:".eventtype","authentication"; json_content:".reason","verification_code_missing"; classtype:system-event; reference:url,help.duo.com/s/article/1023?language=en_US; sid:5014019; rev:1;)

#DUO MFA OHC
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] Successful MFA Authentication from Outside HOME_COUNTRY"; program:duo; json_content:".eventtype","authentication"; json_content:".result","success"; country_code:track by_src,isnot $HOME_COUNTRY; json_map: "src_ip", ".auth_device.ip"; reference:url,https://help.duo.com/s/article/1023?language=en_US; classtype:trojan-activity; sid:5014652; rev:2; metadata:created_at 2024_05_07, updated_at 2024_05_24;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] MFA Authentication Attempt from Outside HOME_COUNTRY"; program:duo; json_content:".eventtype","authentication"; json_content:".result","denied"; country_code:track by_src,isnot $HOME_COUNTRY; json_map: "src_ip", ".access_device.ip"; reference:url,https://help.duo.com/s/article/1023?language=en_US; classtype:trojan-activity; sid:5014653; rev:2; metadata:created_at 2024_05_07, updated_at 2024_05_30;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[DUO] Admin Push Verification Approved from Outside HOME_COUNTRY"; program:duo; json_content:".eventtype","administrator"; json_content:".action","push_verify_approved"; country_code:track by_src,isnot $HOME_COUNTRY; parse_src_ip:1; classtype:system-event; reference:url,help.duo.com; sid:5014654; rev:1;)
