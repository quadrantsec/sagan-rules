# Sagan dynamic.rules
# Copyright (c) 2009-2023. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************
#
# These are 'dynamic' rules.  The purpose of them is to detect logs that might not 
# be being monitored and automatically enable rules and/or warn the operator! 
#
# Need Powershell

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Proftp logs detected via program."; program: proftpd; dynamic_load: $RULE_PATH/proftpd.rules; classtype: dynamic-rules; sid:5003022; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Apache logs detected via program."; program: *apache*|httpd; dynamic_load: $RULE_PATH/apache.rules; classtype: dynamic-rules; sid:5003023; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] APC-EMU logs detected via program."; program: EMU; dynamic_load: $RULE_PATH/apc-emu.rules; classtype: dynamic-rules; sid:5002959; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Arpalert or Arpwatch logs detected via program."; program: arpalert|arpwatch; dynamic_load: $RULE_PATH/arp.rules; classtype: dynamic-rules; sid:5002960; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Artillery logs detected via program."; program: Artillery; dynamic_load: $RULE_PATH/artillery.rules; classtype: dynamic-rules; sid:5002961; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Asterisk logs detected via program."; program: asterisk; dynamic_load: $RULE_PATH/asterisk.rules; classtype: dynamic-rules; sid:5002962; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Bash logs detected via program."; program: bash|-bash|sh|-sh; dynamic_load: $RULE_PATH/bash.rules; classtype: dynamic-rules; sid:5002963; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Bind logs detected via program."; program: named; dynamic_load: $RULE_PATH/bind.rules; classtype: dynamic-rules; sid:5002964; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Bit9 logs detected via program."; program: bit9; dynamic_load: $RULE_PATH/bit9.rules; classtype: dynamic-rules; sid:5002965; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Bro logs detected via program."; program: bro|zeek; dynamic_load: $RULE_PATH/bro-ids.rules; classtype: dynamic-rules; sid:5002966; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Cisco ASA logs detected via program."; program: %ASA*|%FWSM*; dynamic_load: $RULE_PATH/cisco-pixasa.rules; classtype: dynamic-rules; sid:5002967; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Courier/IMAP logs detected via program."; program: imapd|imapd-sslcourierlogger; dynamic_load: $RULE_PATH/courier.rules; classtype: dynamic-rules; sid:5002968; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] OpenSSH logs detected via program."; program: sshd; dynamic_load: $RULE_PATH/openssh.rules; classtype: dynamic-rules; sid:5002969; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] DigitalPersona logs detected via program."; program: *DigitalPersona*; dynamic_load: $RULE_PATH/digitalpersona.rules; classtype: dynamic-rules; sid:5002970; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Dovecot logs detected via program."; program: dovecot; dynamic_load: $RULE_PATH/dovecot.rules; classtype: dynamic-rules; sid:5002971; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] FIPAYPIN logs detected via program."; program: *PIPAYPIN*; dynamic_load: $RULE_PATH/fipaypin.rules; classtype: dynamic-rules; sid:5002972; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] FTPD logs detected via program."; program: ftpd|ftp|FTP|FTPD; dynamic_load: $RULE_PATH/ftpd.rules; classtype: dynamic-rules; sid:5002973; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Grsec logs detected via program."; program: grsec; dynamic_load: $RULE_PATH/grsec.rules; classtype: dynamic-rules; sid:5002974; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Honeyd logs detected via program."; program: honeyd; dynamic_load: $RULE_PATH/honeyd.rules; classtype: dynamic-rules; sid:5002975; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Horde logs detected via program."; program: HORDE; dynamic_load: $RULE_PATH/hordeimp.rules; classtype: dynamic-rules; sid:5002976; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Hostapd logs detected via program."; program: hostapd; dynamic_load: $RULE_PATH/hostapd.rules; classtype: dynamic-rules; sid:5002977; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] IMAPD logs detected via program."; program: imapd|imapd-ssl; dynamic_load: $RULE_PATH/imapd.rules; classtype: dynamic-rules; sid:5002978; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] IPOP3D logs detected via program."; program: ipop3d; dynamic_load: $RULE_PATH/ipop3d.rules; classtype: dynamic-rules; sid:5002979; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Juniper logs detected via program."; program: Juniper; dynamic_load: $RULE_PATH/juniper.rules; classtype: dynamic-rules; sid:5003021; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Kismet_Server logs detected via program."; program: kismet_server; dynamic_load: $RULE_PATH/kismet.rules; classtype: dynamic-rules; sid:5002980; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Knockd logs detected via program."; program: knockd; dynamic_load: $RULE_PATH/knockd.rules; classtype: dynamic-rules; sid:5002981; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Linux kernel logs detected via program."; program: kernel; dynamic_load: $RULE_PATH/linux-kernel.rules; classtype: dynamic-rules; sid:5002982; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] SMTP milter logs detected via program."; program: mimedefang|smf-sav; dynamic_load: $RULE_PATH/milter.rules; classtype: dynamic-rules; sid:5002983; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MongoDB logs detected via program."; program: mongodb|*MongoDB*|*MONGODB*; dynamic_load: $RULE_PATH/mongodb.rules; classtype: dynamic-rules; sid:5002984; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MySQL/MariaDB logs detected via program."; program: mysqld|MySQL; dynamic_load: $RULE_PATH/mysql.rules; classtype: dynamic-rules; sid:5002985; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] NeXpose logs detected via program."; program: NeXpose; dynamic_load: $RULE_PATH/nexpose.rules; classtype: dynamic-rules; sid:5002986; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Nfcapd logs detected via program."; program: nfcapd; dynamic_load: $RULE_PATH/nfcapd.rules; classtype: dynamic-rules; sid:5002987; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Nginx logs detected via program."; program: nginx; dynamic_load: $RULE_PATH/nginx.rules; classtype: dynamic-rules; sid:5002988; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] OpenVPN logs detected via program."; program: openvpn; dynamic_load: $RULE_PATH/openvpn.rules; classtype: dynamic-rules; sid:5002989; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] OSSEC logs detected via program."; program: ossec; dynamic_load: $RULE_PATH/ossec.rules; classtype: dynamic-rules; sid:5002990; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Postfix logs detected via program."; program: postfix; dynamic_load: $RULE_PATH/postfix.rules; classtype: dynamic-rules; sid:5002991; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Postgres logs detected via program."; program: postgres; dynamic_load: $RULE_PATH/postgresql.rules; classtype: dynamic-rules; sid:5002992; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] pptpd logs detected via program."; program: pptpd; dynamic_load: $RULE_PATH/pptpd.rules; classtype: dynamic-rules; sid:5002993; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Pure-FTP logs detected via program."; program: pure-ftpd; dynamic_load: $RULE_PATH/pure-ftpd.rules; classtype: dynamic-rules; sid:5002994; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Racoon logs detected via program."; program: racoon; dynamic_load: $RULE_PATH/racoon.rules; classtype: dynamic-rules; sid:5002995; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Riverbed logs detected via program."; program: webasd; dynamic_load: $RULE_PATH/riverbed.rules; classtype: dynamic-rules; sid:5002996; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Roundcube logs detected via program."; program: webasd; dynamic_load: $RULE_PATH/roundcube.rules; classtype: dynamic-rules; sid:5002998; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Rsync logs detected via program."; program: rsync|rsyncd; dynamic_load: $RULE_PATH/rsync.rules; classtype: dynamic-rules; sid:5002999; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Samba logs detected via program."; program: smbd; dynamic_load: $RULE_PATH/samba.rules; classtype: dynamic-rules; sid:5003000; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Sendmail logs detected via program."; program: sm-mta|sendmail; dynamic_load: $RULE_PATH/sendmail.rules; classtype: dynamic-rules; sid:5003001; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Snort logs detected via program."; program: snort; dynamic_load: $RULE_PATH/snort.rules; classtype: dynamic-rules; sid:5003002; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Squid logs detected via program."; program: squid; dynamic_load: $RULE_PATH/squid.rules; classtype: dynamic-rules; sid:5003032; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] SSH-Tectia-Server logs detected via program."; program: *SSH_Tectia_Server*; dynamic_load: $RULE_PATH/ssh-tectia-server.rules; classtype: dynamic-rules; sid:5003004; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] su/sudo logs detected via program."; program: -su|su|sudo; dynamic_load: $RULE_PATH/su.rules; classtype: dynamic-rules; sid:5003005; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Symantec EMS logs detected via program."; program: pgp/client; dynamic_load: $RULE_PATH/symantec-ems.rules; classtype: dynamic-rules; sid:5003006; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Telnet logs detected via program."; program: telnetd; dynamic_load: $RULE_PATH/telnet.rules; classtype: dynamic-rules; sid:5003007; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Trendmicro Antivirus logs detected via program."; program: TMCM; dynamic_load: $RULE_PATH/trendmicro.rules; classtype: dynamic-rules; sid:5003008; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Tripwire logs detected via program."; program: tripwire|*Tripwire*|*TRIPWIRE*; dynamic_load: $RULE_PATH/tripwire.rules; classtype: dynamic-rules; sid:5003009; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Vmpop3d logs detected via program."; program: vm-pop3d; dynamic_load: $RULE_PATH/vmpop3d.rules; classtype: dynamic-rules; sid:5003010; rev:2;) 
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] VMWare ESXi logs detected via program."; program: vmware-hostd|vmware-authd|Hostd|vmkernel; dynamic_load: $RULE_PATH/vmware.rules; classtype: dynamic-rules; sid:5003011; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] VPopmail logs detected via program."; program: vpopmail; dynamic_load: $RULE_PATH/vpopmail.rules; classtype: dynamic-rules; sid:5003012; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] VSFTPD logs detected via program."; program: vsftpd; dynamic_load: $RULE_PATH/vsftpd.rules; classtype: dynamic-rules; sid:5003013; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Weblabyrinth logs detected via program."; program: weblabyrinth; dynamic_load: $RULE_PATH/weblabrinth.rules; classtype: dynamic-rules; sid:5003014; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MSSQL logs detected via program."; program: *MSSQL*; dynamic_load: $RULE_PATH/windows-mssql.rules; classtype: dynamic-rules; sid:5003015; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Windows Sysmon logs detected via program."; program: *Sysmon*; dynamic_load: $RULE_PATH/windows-sysmon.rules; classtype: dynamic-rules; sid:5003016; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Wordpress logs detected via program."; program: WPsyslog; dynamic_load: $RULE_PATH/wordpress.rules; classtype: dynamic-rules; sid:5003017; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] xinetd logs detected via program."; program: xinetd; dynamic_load: $RULE_PATH/xinetd.rules; classtype: dynamic-rules; sid:5003018; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Yubikey logs detected via program."; program: yk_chkpwd; dynamic_load: $RULE_PATH/yubikey.rules; classtype: dynamic-rules; sid:5003019; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Zeus logs detected via program."; program: zeus; dynamic_load: $RULE_PATH/zeus.rules; classtype: dynamic-rules; sid:5003020; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Cisco ISE detected via program"; program: CISE_Passed_Authentications|CISE_Failed_Attempts|CSCOacs_Failed_Attempts; dynamic_load: $RULE_PATH/cisco-ise.rules; classtype: dynamic-rules; sid:5003785; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] AS400 logs detect via message"; dynamic_load: $RULE_PATH/as400.rules; meta_content: " %sagan% ",MPW1600,MPW1800,MVP1600,MPW2100,MAF1100,MPW1700,MAF0100,MAD2100;classtype: dynamic-rules; sid:5003931; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] AS400 logs detect via program"; dynamic_load: $RULE_PATH/as400.rules; program: CSYS; classtype: dynamic-rules; sid:5003932; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Defender for Cloud App logs detect via message (MCAS)"; dynamic_load: $RULE_PATH/mcas.rules; meta_content: "%sagan%",ALERT_ANUBIS_DETECTION_VELOCITY,ALERT_CABINET_EVENT_MATCH_AUDIT,ALERT_ANUBIS_DETECTION_NEW_COUNTRY,ALERT_DISCOVERY_ANOMALY_DETECTION,ALERT_CABINET_EVENT_MATCH_FILE,ALERT_CABINET_INLINE_EVENT_MATCH,ALERT_CABINET_EVENT_MATCH_OBJECT,ALERT_CABINET_DISCOVERY_NEW_SERVICE,ALERT_PERSONAL_USER_SAGE,ALERT_GEOLOCATION_NEW_COUNTRY,ALERT_ADMIN_USER,ALERT_ZOMBIE_USER,ALERT_NEW_ADMIN_LOCATION,ALERT_COMPROMISED_ACCOUNT,EVENT_CATEGORY_LOGOUT,EVENT_CATEGORY_LOGIN,EVENT_CATEGORY_CREATE_USER,EVENT_CATEGORY_DELETE_USER,ALERT_ANUBIS_DETECTION_REPEATED_ACTIVIY,ALERT_ANUBIS_DETECTION_REPEATED_ACTIVITY_ADMIN_ACTIVITY,ALERT_MANAGEMENT_DISCOVERY_BREACHED_APP; classtype: dynamic-rules; sid:5003933; rev:2;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Watchguard logs detect via program"; dynamic_load: $RULE_PATH/watchguard.rules; program: WatchGuard*; classtype: dynamic-rules; sid:5003934; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Oracle logs detect via message"; dynamic_load: $RULE_PATH/oracle.rules; content: "RETURNCODE|3a|["; classtype: dynamic-rules; sid:5003935; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Zscaler logs detect via message"; dynamic_load: $RULE_PATH/zscaler.rules; content: "requestClientApplication|3d|"; content:!"MCAS"; content:!"Palo Alto Networks"; classtype: dynamic-rules; sid:5003936; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] PowerShell logs detect via program"; dynamic_load: $RULE_PATH/windows-powershell.rules; program: *PowerShell*; classtype: dynamic-rules; sid:5005766; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Mimecast logs detected via message"; content: "aCode="; content: "RcptActType="; dynamic_load: $RULE_PATH/mimecast.rules; classtype: dynamic-rules; sid:5005767; rev:2;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Cloudgenix logs detected via message"; content: "cgxFlowLog"; dynamic_load: $RULE_PATH/cloudgenix.rules; classtype: dynamic-rules; sid:5005773; rev:2;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Darktrace logs detected via program"; program: darktrace; dynamic_load: $RULE_PATH/darktrace.rules; classtype: dynamic-rules; sid:5005838; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] Darktrace logs detected via program"; content: "breachUrl"; content: "model"; dynamic_load: $RULE_PATH/darktrace.rules; classtype: dynamic-rules; sid:5005839; rev:1;)

#Added 2022-09-01 Bryant Smith
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] adtran logs detected via program."; program:FIREWALL; dynamic_load: $RULE_PATH/adtran.rules; classtype:dynamic-rules; sid:5007615; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] attack logs detected via program."; program:cachefsd|ftpd|rpc.statd; dynamic_load: $RULE_PATH/attack.rules; classtype:dynamic-rules; sid:5007616; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] auditd logs detected via program."; program:audispd; dynamic_load: $RULE_PATH/auditd.rules; classtype:dynamic-rules; sid:5007617; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] azure eventhub ad logs detected via program."; program:azureEventHub; dynamic_load: $RULE_PATH/azure-eventhub-ad.rules; classtype:dynamic-rules; sid:5007618; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] barracuda WAF logs detected"; content:" Barracuda - - - -"; dynamic_load: $RULE_PATH/barracuda-waf.rules; classtype:dynamic-rules; sid:5007619; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] cacti thold logs detected via program."; program:CactiTholdLog; dynamic_load: $RULE_PATH/cacti-thold.rules; classtype:dynamic-rules; sid:5007620; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] carbonblack logs detected via program."; program:bit9|carbonblack|cb_cloud; dynamic_load: $RULE_PATH/carbonblack-cloud.rules; classtype:dynamic-rules; sid:5007621; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] centrify logs detected via program."; program:*adclient*|adclient|dzdo; dynamic_load: $RULE_PATH/centrify.rules; classtype:dynamic-rules; sid:5007622; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] cisco amp logs detected via program."; program:CISCO-AMP; dynamic_load: $RULE_PATH/cisco-amp.rules; classtype:dynamic-rules; sid:5007624; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] cisco correlated logs detected via program."; program:%ASA*|CisACS_01_PassedAuth|%SEC_LOGIN-5-LOGIN_SUCCESS; dynamic_load: $RULE_PATH/cisco-correlated.rules; classtype:dynamic-rules; sid:5007626; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] cisco malware logs detected via program."; program:%ASA*-4-106023|%ASA*-6-302013|%ASA*-6-302015; dynamic_load: $RULE_PATH/cisco-malware.rules; classtype:dynamic-rules; sid:5007628; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] cisco wlc logs detected via program."; program:snmptrapd; dynamic_load: $RULE_PATH/cisco-wlc.rules; classtype:dynamic-rules; sid:5007630; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] cloudtrail logs detected via program."; program:*.amazonaws.com; dynamic_load: $RULE_PATH/cloudtrail.rules; classtype:dynamic-rules; sid:5007631; rev:2; metadata: updatedOn 2025_06_04;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] courier correlated logs detected via program."; program:imapd; dynamic_load: $RULE_PATH/courier-correlated.rules; classtype:dynamic-rules; sid:5007632; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] duo logs detected via program."; program:duo; dynamic_load: $RULE_PATH/duo.rules; classtype:dynamic-rules; sid:5007635; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] fatpipe correlated logs detected via program."; program:xtremed; dynamic_load: $RULE_PATH/fatpipe-correlated.rules; classtype:dynamic-rules; sid:5007637; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] fatpipe logs detected via program."; program:xtremed; dynamic_load: $RULE_PATH/fatpipe.rules; classtype:dynamic-rules; sid:5007638; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] imapd correlated logs detected via program."; program:imapd*; dynamic_load: $RULE_PATH/imapd-correlated.rules; classtype:dynamic-rules; sid:5007639; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] incapsula logs detected via program."; program:Incapsula*; dynamic_load: $RULE_PATH/incapsula.rules; classtype:dynamic-rules; sid:5007640; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] mcafee web gateway logs detected via program."; program:mwg; dynamic_load: $RULE_PATH/mcafee-web-gateway.rules; classtype:dynamic-rules; sid:5007642; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] msdns audit logs detected via program."; program:msdns; dynamic_load: $RULE_PATH/msdns-audit.rules; classtype:dynamic-rules; sid:5007643; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] nfcapd malware logs detected via program."; program:nfcapd; dynamic_load: $RULE_PATH/nfcapd-malware.rules; classtype:dynamic-rules; sid:5007644; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] ntp logs detected via program."; program:ntpd*; dynamic_load: $RULE_PATH/ntp.rules; classtype:dynamic-rules; sid:5007645; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] nxlog logs detected via program."; program:nxlog; dynamic_load: $RULE_PATH/nxlog.rules; classtype:dynamic-rules; sid:5007646; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] onelogin logs detected via program."; program:onelogin; dynamic_load: $RULE_PATH/onelogin.rules; classtype:dynamic-rules; sid:5007648; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] openssh correlated logs detected via program."; program:sshd; dynamic_load: $RULE_PATH/openssh-correlated.rules; classtype:dynamic-rules; sid:5007650; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] procurve logs detected via program."; program:00077|00419|auth|FFI|ports|system; dynamic_load: $RULE_PATH/procurve.rules; classtype:dynamic-rules; sid:5007652; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] proofpoint logs detected via program."; program:PROOFPOINT; dynamic_load: $RULE_PATH/proofpoint.rules; classtype:dynamic-rules; sid:5007654; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] solaris logs detected via program."; program:kcfd|rmclomv; dynamic_load: $RULE_PATH/solaris.rules; classtype:dynamic-rules; sid:5007656; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] ssh tectia server correlated logs detected via program."; program:SSH_Tectia_Server; dynamic_load: $RULE_PATH/ssh-tectia-server-correlated.rules; classtype:dynamic-rules; sid:5007658; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] systemd logs detected via program."; program:audit|systemd; dynamic_load: $RULE_PATH/systemd.rules; classtype:dynamic-rules; sid:5007659; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] tcp logs detected via program."; program:TCP; dynamic_load: $RULE_PATH/tcp.rules; classtype:dynamic-rules; sid:5007660; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] vmware correlated logs detected via program."; program:Hostd|vmware-hostd; dynamic_load: $RULE_PATH/vmware-correlated.rules; classtype:dynamic-rules; sid:5007661; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] vsftpd correlated logs detected via program."; program:vsftpd; dynamic_load: $RULE_PATH/vsftpd-correlated.rules; classtype:dynamic-rules; sid:5007662; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] windows applocker logs detected via program."; program:AppLocker; dynamic_load: $RULE_PATH/windows-applocker.rules; classtype:dynamic-rules; sid:5007664; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] windows auth logs detected via program."; program:RemoteAccess|Security|System|TermService; dynamic_load: $RULE_PATH/windows-auth.rules; classtype:dynamic-rules; sid:5007665; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] windows correlated logs detected via program."; program:Security; dynamic_load: $RULE_PATH/windows-correlated.rules; classtype:dynamic-rules; sid:5007667; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] windows emet logs detected via program."; program:*EMET*; content: !"SecurityComplianceCenter"; content:!"SecurityComplianceRBAC"; dynamic_load: $RULE_PATH/windows-emet.rules; classtype:dynamic-rules; sid:5007668; rev:4;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] windows malware logs detected via program."; program:*PrintSpooler*|Security|Service_Control_Manager|System; dynamic_load: $RULE_PATH/windows-malware.rules; classtype:dynamic-rules; sid:5007669; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] windows misc logs detected via program."; program:*Application*|Application|Backup|Bonjour|Citrix|CPQCISSE|crypt32|DAC|DHCP-Server|*Eventlog*|Eventlog|IPSec|LSASRV|*Microsoft_Antimalware*|MsiInstaller|MSSQLSERVER|NtFrs|Ntfs|NtServicePack|Service|SNMP|Symantec|System|Tenable|The|WinRM|WinVNC4; dynamic_load: $RULE_PATH/windows-misc.rules; classtype:dynamic-rules; sid:5007670; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] windows security logs detected via program."; program:Security; dynamic_load: $RULE_PATH/windows-security.rules; classtype:dynamic-rules; sid:5007671; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] zimbra logs detected via program."; program:audit|mailbox|misc-activity|sync|zimbra; dynamic_load: $RULE_PATH/zimbra.rules; classtype:dynamic-rules; sid:5007672; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] zingbox logs detected via program."; program:zws; dynamic_load: $RULE_PATH/zingbox.rules; classtype:dynamic-rules; sid:5007673; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] aws-iam logs detected via program."; program:iam.amazonaws.com; dynamic_load: $RULE_PATH/aws-iam.rules; classtype:dynamic-rules; sid:5008341; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] aws-cloudtrail logs detected via program."; program:cloudtrail.amazonaws.com; dynamic_load: $RULE_PATH/aws-cloudtrail.rules; classtype:dynamic-rules; sid:5008342; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] windows clipboard logs detected via program."; program:clipboard; dynamic_load: $RULE_PATH/windows-clipboard.rules; classtype:dynamic-rules; sid:5008384; rev:1;)
#Bryant Smith 22 Nov 2022
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MSAPI-AirInvestigation logs detected via program"; content:".Workload"; json_map: "program",".Workload"; program:AirInvestigation; dynamic_load: $RULE_PATH/msapi-airinvestigation.rules; classtype:dynamic-rules; sid:5010324; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MSAPI-AzureAD logs detected via program"; content:".Workload"; json_map: "program",".Workload"; program:AzureActiveDirectory; dynamic_load: $RULE_PATH/msapi-azuread.rules; classtype:dynamic-rules; sid:5010325; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MSAPI-Defender logs detected via program"; content:".Workload"; json_map: "program",".Workload"; program:WindowsDefenderAtp; dynamic_load: $RULE_PATH/msapi-defender.rules; classtype:dynamic-rules; sid:5010326; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MSAPI-Exchange logs detected via program"; content:".Workload"; json_map: "program",".Workload"; program:Exchange; dynamic_load: $RULE_PATH/msapi-exchange.rules; classtype:dynamic-rules; sid:5010327; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MSAPI-MCAS logs detected via program"; program:MCAS; dynamic_load: $RULE_PATH/msapi-mcas.rules; classtype:dynamic-rules; sid:5010328; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MSAPI-Onedrive logs detected via program"; content:".Workload"; json_map: "program",".Workload"; program:OneDrive; dynamic_load: $RULE_PATH/msapi-onedrive.rules; classtype:dynamic-rules; sid:5010329; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MSAPI-SecurityComplianceCenter logs detected via program"; content:".Workload"; json_map: "program",".Workload"; program:SecurityComplianceCenter; dynamic_load: $RULE_PATH/msapi-securitycompliancecenter.rules; classtype:dynamic-rules; sid:5010330; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MSAPI-SharePoint logs detected via program"; content:".Workload"; json_map: "program",".Workload"; program:SharePoint; dynamic_load: $RULE_PATH/msapi-sharepoint.rules; classtype:dynamic-rules; sid:5010331; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] MSAPI-ThreatIntelligence logs detected via program"; content:".Workload"; json_map: "program",".Workload"; program:ThreatIntelligence; dynamic_load: $RULE_PATH/msapi-threatintelligence.rules; classtype:dynamic-rules; sid:5010332; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[DYNAMIC] AWS GuardDuty logs detected via program"; program:guardduty; dynamic_load: $RULE_PATH/aws-guardduty.rules; classtype:dynamic-rules; sid:5010455; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Azure AD logs detected via program."; program:azureEventHub; dynamic_load: $RULE_PATH/azureEventHub_azureActivity.rules; classtype:dynamic-rules; sid:5011413; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Bonding logs detected via program."; program:kernel; dynamic_load: $RULE_PATH/bonding.rules; classtype:dynamic-rules; sid:5011414; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Carbonblack USB Approval logs detected via program."; program:cb_usb_approval_data|cb_endpoint_standard; dynamic_load: $RULE_PATH/carbonblack-endpoint-standard.rules; classtype:dynamic-rules; sid:5011415; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] CISCO-ISE-BLACKLIST logs detected via program."; program:CISE_Passed_Authentications; dynamic_load: $RULE_PATH/cisco-ise-blacklist.rules; classtype:dynamic-rules; sid:5011416; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] CISCO-SCA logs detected via program."; program:cisco-sca_data; dynamic_load: $RULE_PATH/cisco-sca-alarms.rules; classtype:dynamic-rules; sid:5011417; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Cyberark logs detected via program."; program:cyberark; dynamic_load: $RULE_PATH/cyberark.rules; classtype:dynamic-rules; sid:5011418; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Cylance logs detected via program."; content:"CylancePROTECT"; dynamic_load: $RULE_PATH/cylance.rules; classtype:dynamic-rules; sid:5011419; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] FortiSandbox logs detected via program."; program:*FortiSandbox*; dynamic_load: $RULE_PATH/fortiSandbox.rules; classtype:dynamic-rules; sid:5011420; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Github logs detected via program."; program:github; dynamic_load: $RULE_PATH/github.rules; classtype:dynamic-rules; sid:5011421; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Knowbe4 logs detected via program."; program:knowbe4; dynamic_load: $RULE_PATH/knowbe4.rules; classtype:dynamic-rules; sid:5011422; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] LibreNMS logs detected via program."; program:librenms; dynamic_load: $RULE_PATH/librenms.rules; classtype:dynamic-rules; sid:5011423; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Netwrix logs detected via program."; program:Netwrix_Auditor_Integration; dynamic_load: $RULE_PATH/netwrix.rules; classtype:dynamic-rules; sid:5011424; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] NinjaRMM logs detected via program."; program:ninjarmm; dynamic_load: $RULE_PATH/ninjarmm.rules; classtype:dynamic-rules; sid:5011425; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Riverbed Aetas logs detected via program."; program:webasd; dynamic_load: $RULE_PATH/riverbed-aetas.rules; classtype:dynamic-rules; sid:5011426; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Sophos Aetas logs detected via program."; program:sophos; dynamic_load: $RULE_PATH/sophos.rules; classtype:dynamic-rules; sid:5011427; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Tenable logs detected via program."; program:tenable_io_data; dynamic_load: $RULE_PATH/tenable.rules; classtype:dynamic-rules; sid:5011428; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS STS logs detected via program."; program:sts.amazonaws.com; dynamic_load: $RULE_PATH/aws-sts.rules; classtype:dynamic-rules; sid:5011437; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS Account logs detected via program."; program:account.amazonaws.com; dynamic_load: $RULE_PATH/aws-account.rules; classtype:dynamic-rules; sid:5011438; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS Access Analyzer logs detected via program."; program:access-analyzer.amazonaws.com; dynamic_load: $RULE_PATH/aws-access-analyzer.rules; classtype:dynamic-rules; sid:5011439; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] CB Protect logs detected via program."; program:cb_protect|cb_app_control; dynamic_load: $RULE_PATH/carbonblack-app-control.rules; classtype:dynamic-rules; sid:5011440; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS AppConfig logs detected via program."; program:appconfig.amazonaws.com; dynamic_load: $RULE_PATH/aws-appconfig.rules; classtype:dynamic-rules; sid:5011601; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS API Gateway logs detected via program."; program:apigateway.amazonaws.com; dynamic_load: $RULE_PATH/aws-apigateway.rules; classtype:dynamic-rules; sid:5011811; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS Application Insights logs detected via program."; program:application-insights.amazonaws.com; dynamic_load: $RULE_PATH/aws-application-insights.rules; classtype:dynamic-rules; sid:5011812; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS AppSync logs detected via program."; program:appsync.amazonaws.com; dynamic_load: $RULE_PATH/aws-appsync.rules; classtype:dynamic-rules; sid:5011813; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS AutoScaling logs detected via program."; program:autoscaling.amazonaws.com; dynamic_load: $RULE_PATH/aws-autoscaling.rules; classtype:dynamic-rules; sid:5011939; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS Athena logs detected via program."; program:athena.amazonaws.com; dynamic_load: $RULE_PATH/aws-athena.rules; classtype:dynamic-rules; sid:5011940; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS Artifact logs detected via program."; program:artifact.amazonaws.com; dynamic_load: $RULE_PATH/aws-artifact.rules; classtype:dynamic-rules; sid:5012070; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS Cognito logs detected via program."; program:cognito.amazonaws.com; dynamic_load: $RULE_PATH/aws-cognito.rules; classtype:dynamic-rules; sid:5012071; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS Detective logs detected via program."; program:detective.amazonaws.com; dynamic_load: $RULE_PATH/aws-detective.rules; classtype:dynamic-rules; sid:5012072; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Microsoft Exchange ActiveMonitoring logs detected via program."; program:Microsoft-Exchange-ActiveMonitoring?ProbeResult; dynamic_load: $RULE_PATH/msexchange-activemonitoring.rules; classtype:dynamic-rules; sid:5012088; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Microsoft Exchange Management logs detected via program."; program:MSExchange_Management; dynamic_load: $RULE_PATH/msexchange-management.rules; classtype:dynamic-rules; sid:5013530; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Airtable logs detected via program."; program:airtable_audit_log_data; dynamic_load: $RULE_PATH/airtables.rules; classtype:dynamic-rules; sid:5013679; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Fortinet logs detected via program."; content:"logid="; meta_content:"type=|22|%sagan%|22|",traffic,event; content:"subtype="; dynamic_load: $RULE_PATH/fortinet.rules; classtype:dynamic-rules; sid:5013795; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] RansomCare logs detected via program."; program:RansomCare; dynamic_load: $RULE_PATH/ransomcare.rules; classtype:dynamic-rules; sid:5013730; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Netwrix logs detected via program."; program:netwrix_auditor_api_data; dynamic_load: $RULE_PATH/netwrix-api-integration.rules; classtype:dynamic-rules; sid:5013789; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Salesforce logs detected via program."; program:salesforce_streaming_api_data; dynamic_load: $RULE_PATH/salesforce.rules; classtype:dynamic-rules; sid:5014058; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS Signin logs detected via program."; program:signin.amazonaws.com; dynamic_load: $RULE_PATH/aws-signin.rules; classtype:dynamic-rules; sid:5014089; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Imperva logs detected via program."; program:Incapsula; dynamic_load: $RULE_PATH/imperva.rules; classtype:dynamic-rules; sid:5014197; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] AWS Secrets Manager logs detected via program."; program:secretsmanager.amazonaws.com; dynamic_load: $RULE_PATH/aws-secretsmanager.rules; classtype:dynamic-rules; sid:5014226; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] JAMF Protect logs detected via program."; program:jamf_protect; dynamic_load: $RULE_PATH/jamf-protect.rules; classtype:dynamic-rules; sid:5014312; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] pfSense logs detected via program."; program:filterlog; dynamic_load: $RULE_PATH/pfsense.rules; classtype:dynamic-rules; sid:5014576; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Linux Auditd logs detected via program."; content:"type="; content:"msg=audit"; dynamic_load: $RULE_PATH/linux-auditd.rules; classtype:dynamic-rules; sid:5014642; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Linux Auth logs detected via program."; content:"pam_unix("; dynamic_load: $RULE_PATH/linux-security.rules; classtype:dynamic-rules; sid:5014643; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Bitdefender GZ logs detected via program."; program:BitdefenderGZ; dynamic_load: $RULE_PATH/bitdefenderGZ.rules; classtype:dynamic-rules; sid:5014677; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Bomgar logs detected via program."; program:bomgar; dynamic_load: $RULE_PATH/bomgar.rules; classtype:dynamic-rules; sid:5014934; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Veeam logs detected via program."; program:veeam; dynamic_load: $RULE_PATH/veeam.rules; classtype:dynamic-rules; sid:5015069; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] ScreenConnect logs detected via program."; program:screenconnect-restful-api_data; dynamic_load: $RULE_PATH/screenconnect.rules; classtype:dynamic-rules; sid:5015126; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] barracuda Email GW logs detected"; content:"hdr_from"; content:"reason_extra"; dynamic_load: $RULE_PATH/barracuda-email-gw-defense.rules; classtype:dynamic-rules; sid:5015834; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] barracuda IR logs detected"; program:Forensics; dynamic_load: $RULE_PATH/barracuda-ir.rules; classtype:dynamic-rules; sid:5015835; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] barracuda Impersonation logs detected"; program:Sentinel; dynamic_load: $RULE_PATH/barracuda-waf.rules; classtype:dynamic-rules; sid:5015836; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Key9 logs detected"; program:k9; dynamic_load: $RULE_PATH/key9.rules; classtype:dynamic-rules; sid:5015958; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Exabeam Logs detected, possible ExtraHop"; program:exabeam-api_data; dynamic_load: $RULE_PATH/extraHop.rules; classtype:dynamic-rules; sid:5016064; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Oracle OCI Logs detected"; program:oci-kafka-consumer_data; dynamic_load: $RULE_PATH/oracle_oci.rules; classtype:dynamic-rules; sid:5016657; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Palo Alto Prisma Logs detected"; program:prisma; dynamic_load: $RULE_PATH/palo-alto_prisma.rules; classtype:dynamic-rules; sid:5017149; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[DYNAMIC] Halcyon Logs detected"; program:halcyon_webapi_data; dynamic_load: $RULE_PATH/halcyon.rules; classtype:dynamic-rules; sid:5017199; rev:1;)
