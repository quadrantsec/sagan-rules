# Sagan fingerprint.rules
# Copyright (c) 2009-2022. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#
# The "fingerprint" signatures are used to help identify "what" is in a network.  If you are using software like 
# Meer (https://github.com/quadrantsec/meer),  "alerts" triggered from "fingerprint" signatures are treated 
# differently.  They can be "re-routed" (to a Redis DB for example) and not treated like a security event. 
# 
# Fingerprint rules are useful in that the data can be bundled with true security "alert" information and relay
# things like services running or used to determine the operating system on the target machine.


alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"airportd service detected"; program: airportd; metadata: fingerprint_source logs, fingerprint_os osx, fingerprint_type client, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100000; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"com.apple.xpc.launchd service detected"; program: com.apple.xpc.launchd; metadata: fingerprint_source logs, fingerprint_os osx, fingerprint_type client, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100001; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"powerd service detected"; program: powerd; metadata: fingerprint_source logs, fingerprint_os osx, fingerprint_type client, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100002; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"syspolicyd service detected"; program: syspolicyd; metadata: fingerprint_source logs, fingerprint_os osx, fingerprint_type client, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100003; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"usernoted service detected"; program: usernoted; metadata: fingerprint_source logs, fingerprint_os osx, fingerprint_type client, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100004; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"hidd service detected"; program: hidd; metadata: fingerprint_source logs, fingerprint_os osx, fingerprint_type client, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100005; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"acpid service running"; program: acpid; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100006; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"eSMTP or lSMTP detected"; program: amavis|amavis-*; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100007; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"anacron service detected"; program: anacron; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100008; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Apache web server running"; program: apache|apache2|httpd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100009; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"auditd service running"; program: auditd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100010; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"bash shell in use"; program: bash|-bash; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100011; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"certbot execution for TLS/SSL cert updates"; program: certbot; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100012; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"clamd anti-virus detected"; program: clamd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100013; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"ksh shell in use"; program: ksh; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100014; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"tcsh shell in use"; program: tcsh; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100015; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"csh shell in use"; program: csh; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100016; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Generic /bin/sh shell in use"; program: sh|-sh; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100017; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"HP Hardware services detected"; program: hpasrd|hpasmlited|cmaeventd|cmaidad|cmanicd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100018; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Generic crond detected"; program: cron|CRON|CROND; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100019; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Cuckoo malware analysis detected"; program: cuckoo; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100020; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Daemonlogger full packet capture engine"; program: daemonlogger; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100021; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"dbus service detected"; program: dbus; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100022; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"dhclient service detected"; program: dhclient; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type client, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100023; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"dhcpd - DHCP server detected"; program: dhcpd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100024; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"exim4 SMTP service detected"; program: exim4; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100025; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Firefox web browser detected"; program: firefox; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type client, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100026; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"SysV init service detected"; program: init; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100029; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Unix 'kernel' messages detected"; program: kernel; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100030; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"knockd service detected"; program: knockd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100031; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"mattermost"; program: mattermost; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type client, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100032; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"MySQL services detected"; program: mysql|mysqld|MySQL; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100033; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"nginx web server running"; program: nginx; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100034; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Linux name service cache daemon detected"; program: nscd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100035; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Network Time Protocol Server detected"; program: ntpd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100036; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"opendkim for SMTP services detected"; program: opendkim; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100037; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenVPN services detected"; program: openvpn|ovpn-*; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100038; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Postfix SMTP services detected"; program: postfix|postfix/*; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100039; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"procmail"; program: procmail; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100040; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"rsync client execution"; program: rsync; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100041; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"rsyncd service detected"; program: rsyncd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100042; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"RSyslog detected"; program: rsyslogd|rsyslogd-*; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100043; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Sagan detected!!"; program: sagan; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100044; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"SASL authentication daemon detected"; program: saslauthd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100045; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Synology Command Execution Management Daemon"; program: scemd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100046; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Sendmail detected"; program: sendmail|sm-*; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100047; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"slapd ldap daemon"; program: slapd ldap daemon; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100048; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"snmpd service running"; program: snmpd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100050; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"snmptrapd service running"; program: snmptrapd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100051; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Snort IDS engine"; program: snort; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100052; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"sshd detected"; program: sshd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100053; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"sSMTP service detected"; program: sSMTP; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100054; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"stunnel service detected"; program: stunnel; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100055; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Suricata IDS engine is running"; program: suricata; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100056; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Generic syslog service detected"; program: syslog|syslogd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100057; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"syslog-ng service detected"; program: syslog-ng; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100059; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"systemd detected"; program: systemd|systemd-*; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 7200; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100060; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"unattended-upgrade (Debian/Ubuntu) detected"; program: unattended-upgrade; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100062; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"yk_chkpwd - Yubikey usage"; program: yk_chkpwd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100063; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"Zimbra services running"; program: zimbra|zimbra*|zmconfigd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; threshold: type limit, track by_src, seconds 3600, count 1; sid: 5100064; rev:1;)

# -----

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Proftp detected"; program: proftpd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100065; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "APC-EMU logs detected"; program: EMU; metadata: fingerprint_source logs, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100066; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Arpalert or Arpwatch logs detected"; program: arpalert|arpwatch; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100067; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Asterisk Phone system detected detected"; program: asterisk; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100068; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: " Bind/DNS server detected"; program: named; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100069; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Bit9 detected"; program: bit9; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100070; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Bro/Zeek detected"; program: bro|zeek; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; classtype: fingerprint; sid:5100071; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: " Cisco ASA detected"; program: %ASA*|%FWSM*; metadata: fingerprint_source logs, fingerprint_os ios, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100072; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Courier/IMAP detected"; program: imapd|imapd-sslcourierlogger; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100073; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "DigitalPersona detected"; program: DigitalPersona*; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100074; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Dovecot detected"; program: dovecot; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100075; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "FIPAYPIN detected"; program: *PIPAYPIN*; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100076; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Gerneric FTPD detected"; program: ftpd|ftp|FTP|FTPD; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100077; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Grsec detected"; program: grsec; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100078; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Honeyd detected"; program: honeyd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100079; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Hostapd detected"; program: hostapd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100080; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "IMAPD detected"; program: imapd|imapd-ssl; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100081; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "IPOP3D detected"; program: ipop3d; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100082; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Juniper detected"; program: Juniper; metadata: fingerprint_source logs, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100083; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Kismet_Server detected"; program: kismet_server; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100084; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "SMTP milter detected"; program: mimedefang|smf-sav; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100085; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "MongoDB server detected"; program: mongodb; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100086; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "NeXpose detected"; program: NeXpose; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100087; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: " Nfcapd detected"; program: nfcapd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100088; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Postgres detected"; program: postgres; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100089; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "pptpd detected"; program: pptpd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100090; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: " PureFTP server detected"; program: pure-ftpd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100091; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Racoon detected"; program: racoon; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100092; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Riverbed detected"; program: webasd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100093; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Samba server detected"; program: smbd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100094; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Squid server detected"; program: squid; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100095; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "SSH-Tectia-Server detected"; program: SSH_Tectia_Server; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100096; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "su/sudo detected"; program: -su|su|sudo; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_expire 7200; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100097; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Symantec EMS detected"; program: pgp/client; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100098; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Telnet service detected"; program: telnetd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100099; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Trendmicro Antivirus Service detected"; program: TMCM; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100100; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Tripwire detected"; program: tripwire; metadata: fingerprint_source logs, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100101; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Vmpop3d service detected"; program: vm-pop3d; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100102; rev:1;) 
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "VMWare ESXi detected"; program: vmware-hostd|vmware-authd|Hostd|vmkernel; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100103; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "VPopmail detected"; program: vpopmail; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100104; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "VSFTPD server detected"; program: vsftpd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100105; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Microsoft MSSQL server detected"; program: MSSQL*; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100106; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Windows Sysmon detected"; program: Sysmon; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100107; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Wordpress detected"; program: WPsyslog; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100116; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "xinetd detected"; program: xinetd; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100108; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Zeus detected"; program: zeus; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100109; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Cisco ISE detected"; program: CISE_Passed_Authentications|CISE_Failed_Attempts|CSCOacs_Failed_Attempts; metadata: fingerprint_source logs, fingerprint_os ios, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; classtype: fingerprint; sid:5100119; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: " AS400 Server detected"; metadata: fingerprint_source logs, fingerprint_os as400, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; meta_content: " %sagan% ",MPW1600,MPW1800,MVP1600,MPW2100,MAF1100,MPW1700,MAF0100,MAD2100;classtype: fingerprint; sid:5100111; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "AS400 Server detect - 2"; metadata: fingerprint_source logs, fingerprint_os as400, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; program: CSYS; classtype: fingerprint; sid:5100112; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Office365 detect"; metadata: fingerprint_source logs, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; meta_content: "%sagan%",ALERT_ANUBIS_DETECTION_VELOCITY,ALERT_CABINET_EVENT_MATCH_AUDIT,ALERT_ANUBIS_DETECTION_NEW_COUNTRY,ALERT_DISCOVERY_ANOMALY_DETECTION,ALERT_CABINET_EVENT_MATCH_FILE,ALERT_CABINET_INLINE_EVENT_MATCH,ALERT_CABINET_EVENT_MATCH_OBJECT,ALERT_CABINET_DISCOVERY_NEW_SERVICE,ALERT_PERSONAL_USER_SAGE,ALERT_GEOLOCATION_NEW_COUNTRY,ALERT_ADMIN_USER,ALERT_ZOMBIE_USER,ALERT_NEW_ADMIN_LOCATION,ALERT_COMPROMISED_ACCOUNT,EVENT_CATEGORY_LOGOUT,EVENT_CATEGORY_LOGIN,EVENT_CATEGORY_CREATE_USER,EVENT_CATEGORY_DELETE_USER,ALERT_ANUBIS_DETECTION_REPEATED_ACTIVIY,ALERT_ANUBIS_DETECTION_REPEATED_ACTIVITY_ADMIN_ACTIVITY,ALERT_MANAGEMENT_DISCOVERY_BREACHED_APP; classtype: fingerprint; sid:5100113; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Watchguard detect"; metadata: fingerprint_source logs, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; program: WatchGuard*; classtype: fingerprint; sid:5100114; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Oracle server detect"; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; content: "RETURNCODE|3a|["; classtype: fingerprint; sid:5100115; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Zscaler detect"; metadata: fingerprint_source logs, fingerprint_os linux, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; content: "requestClientApplication|3d|"; classtype: fingerprint; sid:5100117; rev:1;)

# ---

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Microsoft Windows detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 7200; threshold: type limit, track by_src, seconds 3600, count 1; program: *Microsoft*|*Security*|*Application*|Ntfs|USER32|Service*|*System*; classtype: fingerprint; sid:5100118; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "NXLog detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 7200; threshold: type limit, track by_src, seconds 3600, count 1; program: nxlog; classtype: fingerprint; sid:5100132; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "DHCP-Server detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; program: nxlog; classtype: fingerprint; sid:5100120; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "MS-SQL service detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; program: MSSQL*; classtype: fingerprint; sid:5100121; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Terminal Services detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; program: TermService; classtype: fingerprint; sid:5100122; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Sysmon detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; program: Sysmon; classtype: fingerprint; sid:5100123; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Symantec detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; program: *Symantec*; classtype: fingerprint; sid:5100124; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Applocker detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; program: AppLocker; classtype: fingerprint; sid:5100125; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "VNC detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; program: *VNC*; classtype: fingerprint; sid:5100126; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Apple Bonjour service detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 7200; threshold: type limit, track by_src, seconds 3600, count 1; program: Bonjour; classtype: fingerprint; sid:5100127; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "SNMP service detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_type server, fingerprint_expire 86400; threshold: type limit, track by_src, seconds 3600, count 1; event_id: 1001; program: SNMP; classtype: fingerprint; sid:5100128; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Google updater detected"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 7200; threshold: type limit, track by_src, seconds 3600, count 1; content: "Google update service is active"; classtype: fingerprint; sid:5100129; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Tenable security tool detected [1]"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 7200; threshold: type limit, track by_src, seconds 3600, count 1; program: Tenable; classtype: fingerprint; sid:5100130; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "Tenable security tool detected [2]"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 7200; threshold: type limit, track by_src, seconds 3600, count 1; content: "Tenable Nessus"; classtype: fingerprint; sid:5100131; rev:1;)

#added 23 August 2023 - BS
alert any $HOME_NET any -> $HOME_NET any (msg:"Cisco Meraki device detected"; meta_content:"%sagan%",ip_flow,events,urls,flows,airmarshal_events,firewall,ids-alerts; content:"src="; pcre:"/[0-9]{10}\.[0-9]{9}/"; reference:url,documentation.meraki.com/General_Administration/Monitoring_and_Reporting/Syslog_Event_Types_and_Log_Samples; metadata: fingerprint_source logs, fingerprint_os Meraki-FW, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100133; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Palo Alto device detected"; meta_content:"|2c|%sagan%|2c|",THREAT,TRAFFIC,SYSTEM; meta_content:"|2c|%sagan%|2c|",data,file,flood,packet,scan,spyware,url,virus,vulnerability,wildfire,start,end,deny,drop; meta_nocase; reference:url,docs.paloaltonetworks.com/pan-os/9-1/pan-os-web-interface-help/monitor/monitor-logs/log-types; metadata: fingerprint_source logs, fingerprint_os pan-os, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100134; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Citrix device detected"; content:"-PPE-"; meta_content:" |3a| default %sagan%",TCP,UDP,SSLVPN,SSLLOG; metadata: fingerprint_source logs, fingerprint_os citrix, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100135; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Cisco device detected"; pcre:"/\%[a-zA-Z]{3}-[0-9]-[0-9]{6}/"; reference:url,networklessons.com/cisco/ccie-routing-switching/cisco-ios-syslog-messages; reference:url,www.cisco.com/c/en/us/td/docs/security/firepower/Syslogs/b_fptd_syslog_guide.html; metadata: fingerprint_source logs, fingerprint_os Cisco-FW, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100136; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Fortigate device detected"; content:"devname="; pcre:"/log_*id="*[0-9]{10}\"*/"; metadata: fingerprint_source logs, fingerprint_os forti-os, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100137; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Proofpoint device detected"; program:proofpoint; metadata: fingerprint_source logs, fingerprint_os none, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100138; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Barracuda device detected"; content:"Barracuda - - - -";  metadata: fingerprint_source logs, fingerprint_os barracuda-os, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100139; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Mimecast device detected"; program:MIMECAST; metadata: fingerprint_source logs, fingerprint_os mime-os, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100140; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Microsoft IIS server detected"; program:*IIS*; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100141; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Microsoft Exchange server detected"; program:*Exchange*; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100142; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Microsoft Domain Controller detected"; program:*Security*|*Microsoft-Windows-NTLM*; event_id:4768,8004; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100143; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Microsoft DNS Server detected"; program:*Microsoft-Windows-DNS-Server-Service*; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100144; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"Microsoft Network Share detected"; program:*Security*; event_id:5140; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100145; rev:1;)

alert any $HOME_NET any -> $HOME_NET any (msg:"Airtables application detected"; program:airtable_audit_log_data; metadata: fingerprint_source logs, fingerprint_os airtables, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100146; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Artillery application detected"; program:Artillery; metadata: fingerprint_source logs, fingerprint_os artillery, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; reference:url,github.com/BinaryDefense/artillery; classtype:fingerprint; sid:5100147; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS Access Analyzer detected"; program:access-analyzer.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100148; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS Account detected"; program:account.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100149; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS API Gateway detected"; program:apigateway.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100150; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS AppConfig detected"; program:appconfig.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100151; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS Application Insights detected"; program:application-insights.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100152; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS AppSync detected"; program:appsync.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100153; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS Artifact detected"; program:artifact.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100154; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS Athena detected"; program:athena.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100155; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS Autoscaling detected"; program:autoscaling.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100156; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS Cloudtrail detected"; program:cloudtrail.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100157; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS Cognito detected"; program:cognito.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100158; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS Detective detected"; program:detective.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100159; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS GuardDuty detected"; program:guardduty.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100160; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS IAM detected"; program:iam.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100161; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"AWS STS detected"; program:sts.amazonaws.com; metadata: fingerprint_source logs, fingerprint_os aws, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100162; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Azure Eventhub device detected"; program:azureEventHub; metadata: fingerprint_source logs, fingerprint_os azure, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100163; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Azure Eventhub Active Directory detected"; program:azureEventHub; event_id:4768,8004; metadata: fingerprint_source logs, fingerprint_os azure_ad, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100164; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Carbon Black App Control detected"; program:cb_protect|cb_app_control; metadata: fingerprint_source logs, fingerprint_os carbonblack, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100165; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Carbon Black Cloud detected"; program:bit9|carbonblack; metadata: fingerprint_source logs, fingerprint_os carbonblack, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100166; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Carbon Black Endpoint Server detected"; program:cb_usb_approval_data; metadata: fingerprint_source logs, fingerprint_os carbonblack, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100167; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Centrify detected"; content:"centrifyEventID"; metadata: fingerprint_source logs, fingerprint_os centrify, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100168; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Checkpoint device detected"; content:"[action|3a 22|"; metadata: fingerprint_source logs, fingerprint_os checkpoint, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100169; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Cisco AMP device detected"; program:CISCO-AMP; metadata: fingerprint_source logs, fingerprint_os cisco, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100170; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Cisco ISE device detected"; program:CISE_Failed_Attempts|CSCOacs_Failed_Attempts; metadata: fingerprint_source logs, fingerprint_os cisco, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100171; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Confluent Kafka detected"; content:".data.methodName";content:"kafka."; metadata: fingerprint_source logs, fingerprint_os confluent, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100172; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"CrowdStrike device detected"; program:CrowdStrike; metadata: fingerprint_source logs, fingerprint_os crowdstrike, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100173; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Cyberark device detected"; program:cyberark; metadata: fingerprint_source logs, fingerprint_os cyberark, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100174; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Cylance device detected"; content:"CylancePROTECT"; metadata: fingerprint_source logs, fingerprint_os cylance, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100175; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Darktrace device detected"; program:darktrace; metadata: fingerprint_source logs, fingerprint_os darktrace, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100176; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Duo device detected"; program:duo; metadata: fingerprint_source logs, fingerprint_os duo, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100177; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Fatpipe device detected"; program:xtremed; metadata: fingerprint_source logs, fingerprint_os fatpipe, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100178; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"FortiSandbox device detected"; program:*FortiSandbox*; metadata: fingerprint_source logs, fingerprint_os forti-os, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100179; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Github device detected"; program:github; metadata: fingerprint_source logs, fingerprint_os github, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100180; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Netwrix device detected"; program:netwrix_auditor_api_data; metadata: fingerprint_source logs, fingerprint_os netwrix, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100181; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"Netwrix Windows Active Directory Server detected"; program:netwrix_auditor_api_data; json_content:".DataSource","Active Directory"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100182; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"Netwrix VMware device detected"; program:netwrix_auditor_api_data; json_content:".DataSource","VMware"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100183; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"Netwrix Window Server detected"; program:netwrix_auditor_api_data; json_content:".DataSource","Windows Server"; metadata: fingerprint_source logs, fingerprint_os windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5100184; rev:1;)

#added 21 Sept 2023 BS
alert any $HOME_NET any -> $HOME_NET any (msg:"Halcyon device detected"; program:halcyon_webapi_data; metadata: fingerprint_source logs, fingerprint_os halcyon, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013699; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"HordeImp device detected"; program:HORDE; metadata: fingerprint_source logs, fingerprint_os horde, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013700; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Incapsula device detected"; program:Incapsula*|incapsula*; metadata: fingerprint_source logs, fingerprint_os incapsula, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013701; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Juniper device detected"; program:Juniper; metadata: fingerprint_source logs, fingerprint_os juniper, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013702; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"KnowBe4 device detected"; program:knowbe4; metadata: fingerprint_source logs, fingerprint_os knowbe4, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013703; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"LibreNMS device detected"; program:librenms; metadata: fingerprint_source logs, fingerprint_os librenms, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013704; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"McAfee Web Gateway device detected"; program:mwg; metadata: fingerprint_source logs, fingerprint_os mcafee_web_gateway, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013705; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"MCAS device detected"; meta_content:"ALERT_%sagan%_",ANUBIS,CABINET,DISCOVERY,ADMIN,ZOMBIE; metadata: fingerprint_source logs, fingerprint_os mcafee_web_gateway, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013706; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI AirInvestigation device detected"; json_content: ".Workload","AirInvestigation"; metadata: fingerprint_source logs, fingerprint_os msapi_airinvestigation, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013707; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI AzureAD device detected"; program:AzureActiveDirectory; metadata: fingerprint_source logs, fingerprint_os msapi_azuread, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013708; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Defender device detected"; json_content: ".detectionSource","WindowsDefenderAtp"; metadata: fingerprint_source logs, fingerprint_os msapi_defender, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013709; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Exchange device detected"; json_content: ".Workload","Exchange"; metadata: fingerprint_source logs, fingerprint_os msapi_exchange, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013710; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI MCAS device detected"; json_content: ".Operation", "MCAS_ALERT_"; json_contains; metadata: fingerprint_source logs, fingerprint_os msapi_exchange, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013711; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Microsoft Flow device detected"; json_content: ".Workload","MicrosoftFlow"; metadata: fingerprint_source logs, fingerprint_os msapi_microsoft_flow, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013712; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Microsoft Form device detected"; json_content: ".Workload","MicrosoftForms"; metadata: fingerprint_source logs, fingerprint_os msapi_microsoft_forms, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013713; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Microsoft Stream device detected"; json_content: ".Workload","MicrosoftStream"; metadata: fingerprint_source logs, fingerprint_os msapi_microsoft_stream, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013714; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Microsoft Teams device detected"; json_content: ".Workload","MicrosoftTeams"; metadata: fingerprint_source logs, fingerprint_os msapi_microsoft_teams, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013715; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Microsoft Onedrive device detected"; json_content: ".Workload","OneDrive"; metadata: fingerprint_source logs, fingerprint_os msapi_microsoft_onedrive, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013716; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Microsoft PowerBI device detected"; json_content: ".Workload","PowerBI"; metadata: fingerprint_source logs, fingerprint_os msapi_microsoft_powerbi, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013717; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Security Compliance Center device detected"; program:SecurityComplianceCenter; metadata: fingerprint_source logs, fingerprint_os msapi_microsoft_security, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013718; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Sharepoint device detected"; json_content: ".Workload","SharePoint"; metadata: fingerprint_source logs, fingerprint_os msapi_microsoft_sharepoint, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013719; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"MSAPI Threat Intelligence device detected"; json_content: ".Workload","ThreatIntelligence"; metadata: fingerprint_source logs, fingerprint_os msapi_microsoft_threatintelligence, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013720; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Microsoft Windows Defender device detected"; content:"Windows Defender/Operational";  metadata: fingerprint_source logs, fingerprint_os microsoft-windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013721; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Microsoft DNS device detected"; program:msdns; metadata: fingerprint_source logs, fingerprint_os microsoft-windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013722; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Microsoft Exchange Active Monitoring device detected"; program:Microsoft-Exchange-ActiveMonitoring*; metadata: fingerprint_source logs, fingerprint_os microsoft-windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013723; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Microsoft Exchange Management device detected"; program:MSExchange_Management; metadata: fingerprint_source logs, fingerprint_os microsoft-windows, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013724; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Netwrix device detected"; program:Netwrix_Auditor_Integration; metadata: fingerprint_source logs, fingerprint_os netwrix, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013725; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"NinjaRMM device detected"; program:ninjarmm; metadata: fingerprint_source logs, fingerprint_os ninjarmm, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013726; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"Okta device detected"; json_content:".SOURCE","s_okta-system-log"; metadata: fingerprint_source logs, fingerprint_os okta, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013727; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"OneLogin device detected"; program:onelogin; metadata: fingerprint_source logs, fingerprint_os onelogin, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013728; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"Apache PHP device detected"; program:apache; meta_content:"PHP %sagan%",Fatal,Warning,Parse; metadata: fingerprint_source linux, fingerprint_os onelogin, fingerprint_expire 86400; threshold: type suppress, track by_src, seconds 43200, count 1; classtype:fingerprint; sid:5013729; rev:1;)
