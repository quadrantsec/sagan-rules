# Sagan fortinet.rules
# Copyright (c) 2009-2023. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************
# These are mostly taken from Fortigate 4.0 Message reference manual. 

# These are primarily for Legacy Fortigate logs. New logs are covered by Fortinet-648.rules

# Log Reference: https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/b43f86b1-9e63-11ed-8e6d-fa163e15d75b/FortiOS_7.2.4_Log_Reference.pdf

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Protect profile changed"; content: "32151|22| type="; content: "changed protection profile"; content:!"- - - -"; classtype: configuration-change; sid: 5000898; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] ICMP traffic disallowed"; content: "16003|22| type="; parse_src_ip: 1; content:!"- - - -"; classtype: not-suspicious; sid: 5000899; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Login from LCD"; content: "32001|22| type="; content: "from LCD"; content:!"- - - -"; classtype: successful-admin; sid: 5000900; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Super Administrator Login"; content: "32001|22| type="; content: "logged in"; content:"profile=|22|super_admin|22|"; parse_src_ip: 1; content:!"- - - -"; classtype: successful-admin; sid: 5000901; rev:4;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin login from LCD failed"; content: "32002|22| type="; content: "LCD failed"; content:!"- - - -"; classtype: attempted-admin; sid: 5000902; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin login failed"; content: "32002|22| type="; content: "login failed"; parse_src_ip: 1; content:!"- - - -"; classtype: attempted-admin; sid: 5000903; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] To many bad admin login attempts"; content: "32002|22| type="; content: "bad attempts"; parse_src_ip: 1; content:!"- - - -"; classtype: attempted-admin; sid: 5000904; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Administrator logout"; content: "32003|22| type="; content: "action=logout"; content:!"- - - -"; classtype: not-suspicious; sid: 5000905; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] IPS error mode"; content: "32004|22| type="; content: "error mode"; content:!"- - - -"; classtype: hardware-event; sid: 5000906; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Multiple Admin Login Failures â€“ Brute Force [25/5]"; content: "32002|22| type="; content: "login failed"; parse_src_ip: 1; content:!"- - - -"; classtype: brute-force; xbits: set,brute_force, track ip_src, expire 21600; after: track by_src, count 25, seconds 300; threshold: type suppress, track by_src, count 10, seconds 300; sid: 5000907; rev:13;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Login accepted"; content: "32006|22| type="; content: "login"; meta_content: "%sagan%",accepted,successfully; parse_src_ip: 1; content:!"- - - -"; classtype: successful-admin; sid: 5000908; rev:4;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Disk full or almost full"; content: "32006|22| type="; content: "disk"; nocase; content: "log "; nocase; meta_content: "%sagan%",exceeds,full; content:!"- - - -"; classtype: hardware-event; sid: 5000909; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Fortigate has started"; content: "32006|22| type="; content: "Fortigate started"; content:!"- - - -"; classtype: hardware-event; sid: 5000910; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Fortigate has entered error mode"; content: "32006|22| type="; content: "entered error mode"; content:!"- - - -"; classtype: configuration-error; sid: 5000911; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Fortigate has left error mode"; content: "32006|22| type="; content: "out of error mode"; content:!"- - - -"; classtype: configuration-error; sid: 5000912; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Administrator session timeout"; content: "32007|22| type="; content: "session timed out"; parse_src_ip: 1; content:!"- - - -"; classtype: not-suspicious; sid: 5000913; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Abnormal Admin session drop"; content: "32007|22| type="; content: "terminates the sessions"; parse_src_ip: 1; content:!"- - - -"; classtype: not-suspicious; sid: 5000914; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Normal administrator logout"; content: "32007|22| type="; pcre: "/logs out from|is diconnected by/"; parse_src_ip: 1;  content:!"- - - -"; classtype: not-suspicious; sid: 5000915; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Administrator is clearing/deleting logs"; content: "32007|22| type="; pcre: "/has removed|has deleted|has cleared/"; content:!"- - - -"; classtype: configuration-change; sid: 5000916; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Cannot store config.  Low flash space"; content: "32007|22| type="; content: "Cannot store config"; content: "flash space"; content:!"- - - -"; classtype: hardware-event; sid: 5000917; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin has left current VDOM"; content: "32007|22| type="; content: "has left the virtual domain"; content:!"- - - -"; classtype: not-suspicious; sid: 5000918; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin login failure"; content: "32009|22| type="; content: "login failed from"; content:!"- - - -"; classtype: attempted-admin; sid: 5000919; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Disk logs usage have exceeded"; content: "32010|22| type="; pcre: "/Disk logs|error mode|Log disk|reason=disk-log-full/"; content:!"- - - -"; classtype: hardware-event; sid: 5000920; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Memory usage has exceeded"; content: "32010|22| type="; content: "reason=memory-log-full"; content:!"- - - -"; classtype: hardware-event; sid: 5000921; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Reason unknown error"; content: "32010|22| type="; content: "reason=unknown"; content:!"- - - -"; classtype: hardware-event; sid: 5000922; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Out of error mode"; content: "32012|22| type="; content: "out of error mode"; content:!"- - - -"; classtype: hardware-event; sid: 5000923; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Administrator removed logs"; content: "32013|22| type="; meta_content: "%sagan%",cleared,deleted,removed; content:!"- - - -"; classtype: configuration-change; sid: 5000924; rev:4;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] License about to expired"; content: "32014|22| type="; content: "license will expire"; json_map: "src_ip", ".xff"; threshold: type suppress, track by_src, count 1, seconds 604800; content:!"- - - -"; classtype: program-error; sid: 5000925; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Log disk is full"; content: "32015|22| type="; content: "Log disk is"; content: "full"; content:!"- - - -"; classtype: hardware-event; sid: 5000926; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Corrupted MAC packet detected"; content: "32020|22| type="; content: "Corrupted MAC packet detected"; content:!"- - - -"; classtype: network-event; sid: 5000927; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Action reboot or shutdown"; content: "32095|22| type="; meta_content: "%sagan%",action=reboot,action=shutdown"; content:!"- - - -"; classtype: hardware-event; sid: 5000928; rev:4;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Action reload"; content: "32095|22| type="; content: "action=reload"; content:!"- - - -"; classtype: system-event; sid: 5000929; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Action factory_reset"; content: "32095|22| type="; content: "action=factory_reset"; content:!"- - - -"; classtype: configuration-change; sid: 5000930; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] New access profile added"; content: "32101|22| type="; content: "added new access profile"; content:!"- - - -"; classtype: configuration-change; sid: 5000931; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Configuration change"; content: "32102|22| type="; content: "made a change"; content:!"- - - -"; classtype: configuration-change; sid: 5000932; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Access profile changed"; content: "32102|22| type="; content: "setting of access profile"; content:!"- - - -"; classtype: configuration-change; sid: 5000933; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Access profile deleted"; content: "32103|22| type="; content: "deleted an access profile"; content:!"- - - -"; classtype: configuration-change; sid: 5000934; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] New admin user added"; content: "32120|22| type="; content: "added an admin user"; content:!"- - - -"; classtype: configuration-change; sid: 5000935; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] New user group added"; content: "32120|22| type="; content: "added an user group"; content:!"- - - -"; classtype: configuration-change; sid: 5000936; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin changed another admin's password"; content: "32150|22| type="; content: "changed password of admin"; content:!"- - - -"; classtype: configuration-change; sid: 5000971; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Flash memory is full!"; content: "20031|22| type="; content: "flash memory is full"; content:!"- - - -"; classtype: hardware-event; sid: 5000937; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin authentication success"; content: "38001|22| type="; content: "succeeded in authentication"; content:!"- - - -"; classtype: successful-admin; sid: 5000938; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin authentication failure"; content: "38001|22| type="; content: "failed in authentication"; content:!"- - - -"; classtype: attempted-admin; sid: 5000939; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin authentication failure"; content: "38002|22| type="; pcre: "/failed to authenticate|failed in authentication/i"; parse_src_ip: 1; content:!"- - - -"; classtype: attempted-admin; sid: 5000940; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Failed authentication to many times"; content: "38003|22| type="; content: "failed authentication to many times"; content:!"- - - -"; classtype: attempted-admin; sid: 5000941; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Chassis fan anomaly"; content: "99503|22| type="; content: "Chassis fan anomaly"; content:!"- - - -"; classtype: hardware-event; sid: 5000942; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Chassis temperature anomaly"; content: "99504|22| type="; content: "Chassis temperature anomaly"; content:!"- - - -"; classtype: hardware-event; sid: 5000943; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Chassis voltage anomaly"; content: "99505|22| type="; content: "Chassis voltage anomaly"; content:!"- - - -"; classtype: hardware-event; sid: 5000944; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Blade fan anomaly"; content: "99506|22| type="; content: "Blade fan anomaly"; content:!"- - - -"; classtype: hardware-event; sid: 5000945; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Blade temperature anomaly"; content: "99507|22| type="; content: "Blade temperature anomaly"; content:!"- - - -"; classtype: hardware-event; sid: 5000946; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Blade voltage anomaly"; content: "99508|22| type="; content: "Blade voltage anomaly"; content:!"- - - -"; classtype: hardware-event; sid: 5000947; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Authentication success"; content: "29002|22| type="; content: "action=auth_success"; content:!"- - - -"; classtype: successful-user; sid: 5000948; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Authentication failed"; content: "29003|22| type="; content: "action=auth_failed"; content:!"- - - -"; classtype: unsuccessful-user; sid: 5000949; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Max connection reached"; content: "29004|22| type="; content: "No more clients can connect"; content:!"- - - -"; classtype: system-event; sid: 5000950; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Not enough memory"; content: "29024|22| type="; content: "not enough memory"; content:!"- - - -"; classtype: hardware-event; sid: 5000951; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Data Leak Prevention Rule Matched"; content: "11000|22| type="; content: "Data Leak Prevention Rule matched"; content:!"- - - -"; classtype: policy-violation; sid: 5000952; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant messaging message"; content: "11600|22| type="; content: "kind="; content:!"- - - -"; classtype: policy-violation; sid: 5000953; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message file tranfer message"; content: "116001|22| type="; content: "kind="; content:!"- - - -"; classtype: policy-violation; sid: 5000954; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message chat message"; content: "116002|22| type="; content: "kind="; content:!"- - - -"; classtype: policy-violation; sid: 5000955; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Control instant message SIP session blocked message"; content: "116003|22| type="; content: "kind="; content:!"- - - -"; classtype: policy-violation; sid: 5000956; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message message"; content: "116010|22| type="; content: "kind="; content:!"- - - -"; classtype: policy-violation; sid: 5000957; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] An application control VoIP-SIP session blocked message"; content: "116011|22| type="; content: "kind="; content:!"- - - -"; classtype: policy-violation; sid: 5000958; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] E-mail of an infected file"; content: "60000|22| type="; content:!"- - - -"; classtype: suspicious-traffic; sid: 5000959; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] File blocked via e-mail"; content: "63000|22| type="; content:!"- - - -"; classtype: suspicious-traffic; sid: 5000960; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] File intercepted via e-mail"; content: "63002|22| type="; content:!"- - - -"; classtype: suspicious-traffic; sid: 5000961; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack signature matched [see content] [1]"; content: "70000|22| type="; content:!"- - - -"; classtype: misc-attack; sid: 5000962; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack signature matched [see content] [2]"; content: "73001|22| type="; content:!"- - - -"; classtype: misc-attack; sid: 5000963; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Banned word was found"; content: "90000|22| type="; content:!"- - - -"; classtype: policy-violation; sid: 5000964; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Cookie was removed"; content: "91000|22| type="; content:!"- - - -"; classtype: web-application-activity; sid: 5000965; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Java applet was removed"; content: "91005|22| type="; content:!"- - - -"; classtype: web-application-activity; sid: 5000966; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] ActiveX script was removed"; content: "91010|22| type="; content:!"- - - -"; classtype: web-application-activity; sid: 5000967; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL was in blacklist"; content: "93002|22| type="; content:!"- - - -"; classtype: policy-violation; sid: 5000968; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL belongs to a denied category"; content: "99501|22| type="; content:!"- - - -"; classtype: policy-violation; sid: 5000969; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] calloc failed"; content: "93007|22| type="; content: "calloc"; content: "failed"; content:!"- - - -"; classtype: hardware-event; sid: 5000970; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] FTP attempt"; content: "80000|22| type="; content: "user="; content: "group="; content:!"- - - -"; classtype: suspicious-traffic; sid: 5000972; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Entered system conserve mode!"; content: "22802|22| type="; content: "entered system conserve mode"; content:!"- - - -"; classtype: hardware-event; sid: 5000973; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Leaving system conserve mode"; content: "22803|22| type="; content: "exited system conserve mode"; content:!"- - - -"; classtype: hardware-event; sid: 5000974; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] General CRITICAL event"; content: "devname="; content: "pri=critical"; content:!"Alarm Cleared"; content:!"logged out from"; content:!"physical-port-change"; content:!"- - - -"; classtype: hardware-event; sid: 5000975; rev:4;)

# 01/04/2013
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Botnet traffic detected"; content: "app_list=|22|BotnetOnly|22| app_type=|22|Botnet|22|"; content:!"- - - -"; classtype: trojan-activity; parse_src_ip: 1; parse_dst_ip: 2; sid: 5001627; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSH traffic detected"; content: " service=SSH "; content:!"- - - -"; classtype: trojan-activity; parse_src_ip: 1; parse_dst_ip: 2; sid: 5001970; rev:2;)

#*************************************************************
#The below are new Fortinet rules
# These are mostly taken from Fortigate 6.4.8 Message reference manual.
#Written by Charles Goggins - Quadrant Information Security

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] IPS Session Scan Paused"; content: "logid=|22|0100022700|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-error; sid: 5006040; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Compromised Host Detected"; content: "logid=|22|0100022953|22|"; content: "type="; content: "subtype="; content:!"level=|22|warning|22|"; content:!"- - - -"; classtype: malware; parse_src_ip: 1; sid: 5006041; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] FortiGuard Message Service Status"; content: "logid=|22|0100022916|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; sid: 5006042; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] IPv6 firewall inbound policy added"; content: "logid=|22|0100032151|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: configuration-change; sid: 5006043; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Successful Admin Login"; content: "logid=|22|0100032001|22|"; content:!"jsconsole"; content: "type="; content: "subtype="; threshold: type suppress, track by_src, count 1, seconds 86400; content:!"- - - -"; classtype: successful-admin; parse_src_ip: 2; parse_dst_ip: 3; sid: 5006044; rev:2;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Successful Admin Login [2]"; content: "logid=|22|0100032001|22|"; content: "jsconsole"; content: "type="; content: "subtype="; threshold: type suppress, track by_src, count 1, seconds 86400; content:!"- - - -"; classtype: successful-admin; parse_src_ip: 1; parse_dst_ip: 2; sid: 5012082; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Login Failed [5/25]"; content: "logid=|22|0100032002|22|"; content: "type="; content: "subtype="; after: track by_src, count 5, seconds 1500; content:!"- - - -"; classtype: attempted-admin; parse_src_ip: 2; parse_dst_ip: 3; sid: 5006045; rev:2;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin logout successful"; content: "logid=|22|0100032003|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: not-suspicious; parse_src_ip: 2; parse_dst_ip: 3; sid: 5006046; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VDOM overwritten by Admin"; content: "logid=|22|0100032005|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; sid: 5006047; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Super admin entered VDOM"; content: "logid=|22|0100032006|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; sid: 5006048; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Super admin left VDOM"; content: "logid=|22|0100032007|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; sid: 5006049; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] FortiGate Started"; content: "logid=|22|0100032009|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; sid: 5006050; rev:31)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Logs deleted by user"; content: "logid=|22|0100032044|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; sid: 5006051; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Support License expiring"; content: "logid=|22|0100032014|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: program-error; sid: 5006052; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Corrupted MAC packet detected"; content: "logid=|22|0100032020|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: network-event; sid: 5006053; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Performed Action from GUI"; content: "logid=|22|0100032095|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: configuration-change; sid: 5006054; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Configuration change"; content: "logid=|22|0100032102|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: configuration-change; parse_src_ip: 1; sid: 5006055; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] New Firmware Available on FortiGuard"; content: "logid=|22|0100032103|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: not-suspicious; sid: 5006056; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Password Expired"; content: "logid=|22|0100032024|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; sid: 5006057; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Authentication success"; content: "logid=|22|0100029002|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: successful-user; sid: 5006058; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Authentication failed"; content: "logid=|22|0100029003|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: unsuccessful-user; sid: 5006059; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Max connection reached"; content: "logid=|22|0101040014|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; sid: 5006060; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Data Leak Prevention Rule Matched"; content: "logid=|22|0954024576|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: policy-violation; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006061; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant messaging message"; content: "logid=|22|1059028672|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: policy-violation; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006062; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message - file tranfer message"; content: "logid=|22|1059028675|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: policy-violation; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006063; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message chat message"; content: "logid=|22|1059028676|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: policy-violation; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006064; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VoIP-SIP session blocked"; content: "logid=|22|0814044033|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: policy-violation; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006065; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Infected File Detected Within Email"; content: "logid=|22|0211008194|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006066; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by UDP/TCP Signature"; content: "logid=|22|0419016384|22|"; content: "type="; content: "subtype="; content: !"action=|22|dropped|22|"; meta_content:!"severity=|22|%sagan%|22|",info,low,medium; content:!"- - - -"; classtype: misc-attack; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006067; rev:5; metadata: updated_at 2024_07_24;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by ICMP Signature"; content: "logid=|22|0419016385|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: misc-attack; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006068; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by Other Signature"; content: "logid=|22|0419016386|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: misc-attack; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006069; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by Malicious URL"; content: "logid=|22|0421016399|22|"; content: "type="; content: "subtype="; content:!"URL blocked "; content:!"- - - -"; classtype: misc-attack; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006070; rev:2;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Botnet C&C Communication - Warning"; content: "logid=|22|0402016400|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: misc-attack; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006071; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Web - Banned word was found"; content: "logid=|22|0314012288|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: policy-violation; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006072; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Cookie Removed Entirely"; content: "logid=|22|0336013601|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: web-application-activity; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006073; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Cookie Removed"; content: "logid=|22|0336013573|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: web-application-activity; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006074; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Java applet was removed"; content: "logid=|22|0337013584|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: web-application-activity; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006075; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] ActiveX script was removed"; content: "logid=|22|0335013568|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: web-application-activity; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006076; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Script Entity Removed"; content: "logid=|22|0341013600|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: web-application-activity; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006077; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Blocked per Filter"; content: "logid=|22|0315012544|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: policy-violation; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006078; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Exempt per Filter"; content: "logid=|22|0315012545|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: not-suspicious; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006079; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Allowed per Filter"; content: "logid=|22|0315012546|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: not-suspicious; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006080; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Belongs to Blocked Category Within Firewall Policy"; content: "logid=|22|0316013056|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: policy-violation; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006081; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Belongs to Allowed Category Within Firewall Policy"; content: "logid=|22|0317013312|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: not-suspicious; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006082; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  Outdated Report Files Deleted"; content: "logid=|22|0100020027|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; threshold: type limit, track by_src, count 1, seconds 86400; sid: 5006083; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  Disk Log File Deleted"; content: "logid=|22|0100032029|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; sid: 5006084; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  New SSL VPN Connection From Outside HOME_COUNTRY"; content: "logid=|22|0101039943|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; country_code: track by_src, isnot $HOME_COUNTRY; sid: 5006085; rev:1;) #Disabled in favor of successful login via VPN from outside home country


alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Successful VPN Login From Outside HOME_COUNTRY"; content: "logid=|22|0101039424|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: suspicious-traffic; parse_src_ip: 1; country_code: track by_src, isnot $HOME_COUNTRY; sid: 5007684; rev:1;) 

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  SSL Decryption Failed"; content: "logid=|22|0105048009|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-error; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006086; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL VPN Alert"; content: "logid=|22|0101039944|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; sid: 5006087; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Fatal Alert Received"; content: "logid=|22|0105048038|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006088; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Authentication Logon"; content: "logid=|22|0102043039|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; sid: 5006089; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Authentication Logout"; content: "logid=|22|0102043040|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; sid: 5006090; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Report Deleted"; content: "logid=|22|0100032040|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; sid: 5006091; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Monitor login Successful"; content: "logid=|22|0100032053|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006092; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Infected File Detected and Blocked"; content: "logid=|22|0211008192|22|"; content: "type="; content: "subtype="; content:!"subject="; pcre:"/srcip=(10\.\d{1,3}\.\d{1,3}\.\d{1,3}|172.([12][0-9]|3[0-2])\.\d{1,3}\.\d{1,3}|192\.168\.\d{1,3}\.\d{1,3})/"; threshold: type suppress, track by_dst, count 1, seconds 14400; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006093; rev:5; metadata: updated_on 2025_12_04;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Virus Command Blocked"; content: "logid=|22|0206008452|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006094; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] App-Control IPS Pass"; content: "logid=|22|1059028704|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006095; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] App-Control IPS Block"; content: "logid=|22|1059028705|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006096; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - Blocked"; content: "logid=|22|1700062303|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006097; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - Disallow list"; content: "logid=|22|1700062300|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006098; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - SNI Mismatched"; content: "logid=|22|1700062304|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006099; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] DNS - Domain Belongs to a Denied Category in Policy"; content: "logid=|22|1501054803|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006100; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Web Filter Rating Error Occurred"; content: "logid=|22|0318012800|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-error; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006101; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by UDP/TCP Anomaly"; content: "logid=|22|0720018432|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: misc-attack; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006102; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by ICMP Anomaly"; content: "logid=|22|0720018433|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: misc-attack; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006103; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by Other Anomaly"; content: "logid=|22|0720018434|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: misc-attack; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006104; rev:1;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Login Disabled"; content: "logid=|22|0100032021|22|"; content: "type="; content: "subtype="; content:!"- - - -"; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; sid: 5006105; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Login Failed via VPN - Brute Force [10/5]"; content: "logid=|22|0101039426|22|"; content: "type="; content: "subtype="; parse_src_ip: 1; normalize; after: track by_src&by_username, count 10, seconds 300; flexbits: set, brute_force, 21600; threshold: type suppress, track by_src, count 1, seconds 21600; content:!"- - - -"; classtype: brute-force; sid: 5006611; rev:5;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VPN Login After Brute Force "; content: "logid=|22|0101039424|22|"; content: "type="; content: "subtype="; normalize; parse_src_ip: 1; flexbits: isset, by_src, brute_force; flexbits: isset, username, brute_force; threshold: type suppress, track by_src&by_username, count 1, seconds 3600; content:!"- - - -"; classtype: correlated-attack; sid: 5006612; rev:2;)

alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Possible CVE-2022-40684 Indicators Detected v1"; content:"type=|22|event|22|"; content:"user=|22|Local_Process_Access|22|"; content:"ui=|22|Node.js|22|"; reference:url,www.horizon3.ai/fortinet-iocs-cve-2022-40684/; content:!"- - - -"; classtype:attempted-admin; sid:5008401; rev:1;)

alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Possible CVE-2022-40684 Indicators Detected v2"; content:"type=|22|event|22|"; content:"user=|22|Local_Process_Access|22|"; content:"ui=|22|Report Runner|22|"; reference:url,www.horizon3.ai/fortinet-iocs-cve-2022-40684/; content:!"- - - -"; classtype:attempted-admin; sid:5008402; rev:1;)

alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Filesystem write violation (LOG_ID_SYS_SECURITY_WRITE_VIOLATION)"; content:"20230|22 20|type="; content:"subtype=|22|system|22|"; reference:url,docs.fortinet.com/document/fortigate/7.4.0/new-features/226732/real-time-file-system-integrity-checking; content:!"- - - -"; classtype:malware; sid:5013790; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Attempt to replace symlink (LOG_ID_SYS_SECURITY_HARDLINK_VIOLATION)"; content:"20231|22 20|type="; content:"subtype=|22|system|22|"; reference:url,docs.fortinet.com/document/fortigate/7.4.0/new-features/226732/real-time-file-system-integrity-checking; content:!"- - - -"; classtype:malware; sid:5013791; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Non-Kernel module loading (LOG_ID_SYS_SECURITY_LOAD_MODULE_VIOLATION)"; content:"20232|22 20|type="; content:"subtype=|22|system|22|"; reference:url,docs.fortinet.com/document/fortigate/7.4.0/new-features/226732/real-time-file-system-integrity-checking; content:!"- - - -"; classtype:malware; sid:5013792; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] File Hash does not match (LOG_ID_SYS_SECURITY_FILE_HASH_MISMATCH)"; content:"20234|22 20|type="; content:"subtype=|22|system|22|"; reference:url,docs.fortinet.com/document/fortigate/7.4.0/new-features/226732/real-time-file-system-integrity-checking; content:!"- - - -"; classtype:malware; sid:5013793; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[FORTINET] Administrator Login from External IP address"; content:"32001|22| type="; content:"logged in"; parse_src_ip:1; pcre:"/from\s\w+\((\d+)(?<!10)\.(\d+)(?<!192\.168)(?<!172\.(1[6-9]|2\d|3[0-1]))\.(\d+)\.(\d+)/"; content:!"- - - -"; classtype:successful-admin; sid:5013794; rev:1;)

#Added 03/27/2023 by BS
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM virus Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|virus|22|"; content:"eventtype=|22|infected|22|"; content:!"severity=low"; meta_content:!"level=|22|%sagan%|22|",notice,information; content:!"logid=|22|0211008192|22|"; content:!"eventtype=|22|analytics|22|"; parse_src_ip:2; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014339; rev:1;)

alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM Multiple Webfilter Events Detect from a Single Source [250/1]"; content:" type=|22|utm|22|"; content:" subtype=|22|webfilter|22|"; meta_content:"catdesc=|22|%sagan%",File|20|Sharing|20|and|20|Storage,Remote|20|Access,Child|20|Sexual|20|Abuse,Crypto|20|Mining,Hacking,Terrorism,Potentially|20|Unwanted|20|Program,Dynamic|20|DNS,Malicious|20|Websites,Newly|20|Observed|20|Domain,Newly|20|Registered|20|Domain,Phishing,Spam|20|URLs,Unrated,Not|20|Rated; meta_content:!"catdesc=|22|%sagan%",Advertising,Freeware,Meaningless,File|20|Sharing,Instant|20|Messaging; pcre:"/srcip=(?:(10\.|172\.(1[6-9]|2[0-9]|3[0-1])\.|192\.168\.))\d{1,3}\.\d{1,3}\.\d{1,3}/"; pcre:"/dstip=(?!(10\.|172\.(1[6-9]|2[0-9]|3[0-1])\.|192\.168\.))\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/"; meta_content:!"eventtype=|22|%sagan%|22|",ftgd_allow; meta_content:!"crlevel|22 3a||22|%sagan%|22|",low,medium; content:!"severity|22 3a|low"; meta_content:!"level|22 3a||22|%sagan%|22|",notice,information; content:!".tiktokv.com"; content:!".tiktokcdn-us.com"; content:!"Microsoft-WebDAV-MiniRedir"; content: !"Microsoft-Delivery-Optimization"; meta_content: !"%sagan%",|2e|gov,|2e|edu|2e|local,collector|2e|azure|2e|microsoft|2e|scloud; content:!".live.net"; content:!"oneclient.sfx.ms"; content:!".delivery.mp.microsoft.com"; content:!"icloud.com"; after:track by_src,count 250, seconds 7200; threshold:type suppress, track by_src, count 1, seconds 86400; parse_src_ip:1; parse_dst_ip:2; normalize; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014340; rev:5; metadata:updated_at 2024_06_05;)

#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM ips Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|ips|22|"; meta_content:!"severity=|22|%sagan%|22|",low,info; content:!"level=|22|notice|22|"; content:!"crlevel=|22|low|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014341; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM emailfilter Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|emailfilter|22|"; content:!"severity=low"; meta_content:!"level=|22|%sagan%|22|",notice,information; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014342; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM Anomaly Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|anomaly|22|"; content:"severity=critical"; content:!"level=|22|notice|22|"; content:!"policytype=|22|DoS-policy|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014343; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM voip Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|voip|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; content:!"- - - -"; classtype:system-event; parse_src_ip:1; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014344; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM dlp Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|dlp|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014345; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM app-ctl Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|app-ctl|22|"; content:!"severity=low"; meta_content:!"level=|22|%sagan%|22|",information,notice; meta_content:!"apprisk=|22|%sagan%|22|",low,medium; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014346; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM WAF Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|waf|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014347; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM WAF Custom Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|waf|22|"; content:"eventtype=waf-custom-signature"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014348; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM gtp Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|gtp|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014349; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM dns Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|dns|22|"; meta_content:"catdesc=|22|%sagan%",File|20|Sharing|20|and|20|Storage,Remote|20|Access,Child|20|Sexual|20|Abuse,Crypto|20|Mining,Hacking,Terrorism,Dynamic|20|DNS,Malicious|20|Websites,Newly|20|Registered|20|Domain,Phishing,Unrated,Not|20|Rated; content:!"action=|22|redirect|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; content:!".live.net"; content:!"oneclient.sfx.ms"; content:!".delivery.mp.microsoft.com"; content:!"icloud.com"; meta_content:!"%sagan%",|2e|local,|2e|internal,wpad|2e|; parse_src_ip:1; parse_dst_ip:2; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; reference:url,https://community.fortinet.com/t5/FortiGate/Troubleshooting-Tip-DNS-Filter-profile-Redirect-to-Fortinet/ta-p/227243; sid:5014350; rev:4; metadata:updated_at 2024_05_16;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM ssh Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|ssh|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014351; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM ssl Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|ssl|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014352; rev:1;)

alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM file-filter Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|file-filter|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; content:!"hostname=|22|adl.windows.com|22|"; content:!".windowsupdate.com|22|"; content:!"hostname=|22|edgedl.me.gvt1.com|22|"; meta_content: !"%sagan%", Microsoft-WebDAV-MiniRedir,Microsoft-Delivery-Optimization; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014353; rev:2; metadata: updated_on 2024_06_05;)

alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM icap Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|icap|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014354; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM forti-switch Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|forti-switch|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014355; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM virtual-patch Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|virtual-patch|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014356; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM casb Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|casb|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:1; content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014357; rev:1;)

alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Botnet Communication Detected"; content:"trigger=Default-Botnet-Communication-Detection-By-"; meta_content:!"action=|22|%sagan%|22|",dropped,blocked; parse_src_ip:1; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; content:!"- - - -"; classtype:trojan-activity; sid:5014358; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Botnet Communication Detected - Direction Outgoing"; content:"trigger=Default-Botnet-Communication-Detection-By-"; content:"direction=|22|outgoing|22|"; pcre:"/srcip=(10(\.(1?\d\d?|2([0-4]\d?|5[0-5])))(?2)|172\.(1[6-9]|2\d|3[0-2])(?2)|192\.168(?2))(?2)/"; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:1; content:!"- - - -"; classtype:trojan-activity; sid:5014359; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Compromised Host Detected"; content:"trigger=Default-Compromised Host-Detection-IOC-By-"; content:!"type=|22|traffic|22|"; meta_content:!" level=|22|%sagan%|22|",warning,notice; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:1; content:!"- - - -"; classtype:trojan-activity; sid:5014360; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Sandbox Detections Event"; content:"trigger=Default-Sandbox-Detections-By-"; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:1; content:!"- - - -"; classtype:trojan-activity; sid:5014361; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Malicious File Detected"; content:"trigger=Default-Malicious-File-Detection-By-"; content:!"action=|22|blocked|22|"; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:1; content:!"- - - -"; classtype:trojan-activity; sid:5014362; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Malicious File Detected - Direction Outgoing"; content:"trigger=Default-Malicious-File-Detection-By-"; content:"direction=|22|outgoing|22|"; content:!"subject="; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:1; content:!"- - - -"; classtype:trojan-activity; sid:5014363; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Malicious Code Detected"; content:"trigger=Default-Malicious-Code-Detection-By-"; meta_content:!"severity=|22|%sagan%|22|",info,low; meta_content:!"action=|22|%sagan%|22|",dropped,blocked; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:2; content:!"- - - -"; classtype:trojan-activity; sid:5014364; rev:2; metadata: updated_on 2024_05_28;)

alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Malicious Code Detected - Direction Outgoing"; content:"subject=Intrusion "; content:"trigger=Default-Malicious-Code-Detection-By-"; content:!"severity=|22|info|22|"; pcre:"/srcip=(?:(10\.|172\.(1[6-9]|2[0-9]|3[0-1])\.|192\.168\.))\d{1,3}\.\d{1,3}\.\d{1,3}/"; pcre:"/dstip=(?!(10\.|172\.(1[6-9]|2[0-9]|3[0-1])\.|192\.168\.))\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/"; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:2; parse_dst_ip:3; content:!"- - - -"; classtype:trojan-activity; sid:5014365; rev:4;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Risky Destination Detected [100/1]"; content:"trigger=Default-Risky-Destination-Detection-By-"; content:!"eventtype=|22|ftgd_allow|22|"; after:track by_src&by_dst,count 100,seconds 7200; threshold:type suppress,track by_src&by_dst,count 1, seconds 86400; parse_src_ip:1; parse_dst_ip:2; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:1; content:!"- - - -"; classtype:trojan-activity; sid:5014366; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Risky Application Detected"; content:"trigger=Default-Risky-App-Detection-By-"; content:!"msg=|22|Proxy: Proxy.HTTP|22|"; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:1; content:!"- - - -"; classtype:trojan-activity; sid:5014367; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM dns Event Detected - Possible C2 Traffic [250/1]"; content:" type=|22|utm|22|"; content:" subtype=|22|dns|22|"; meta_content:"catdesc=|22|%sagan%",File|20|Sharing|20|and|20|Storage,Remote|20|Access,Child|20|Sexual|20|Abuse,Crypto|20|Mining,Hacking,Terrorism,Potentially|20|Unwanted|20|Program,Dynamic|20|DNS,Malicious|20|Websites,Newly|20|Observed|20|Domain,Newly|20|Registered|20|Domain,Phishing,Spam|20|URLs,Unrated,Not|20|Rated; content:!"severity=low"; content:!"level=|22|notice|22|"; content:!".live.net"; content:!"oneclient.sfx.ms"; content:!".delivery.mp.microsoft.com"; content:!"icloud.com"; meta_content:!"%sagan%",|2e|local,|2e|internal,wpad|2e|; parse_src_ip:1; parse_dst_ip:2; after:track by_src,count 250, seconds 7200; threshold:type suppress, track by_src, count 1, seconds 86400 content:!"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014655; rev:1; metadata:updated_at 2024_05_16;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Possible FortiManager Compromise - Unregistered Device - CVE-2024-47575"; content:"type=event"; content:"subtype=dvm"; content:"Unregistered device"; nocase; content:"add succeeded"; nocase; parse_src_ip:1; normalize; reference:url,https://socradar.io/fortimanager-zero-day-fortijump-is-now-publicly-addressed-cve-2024-47575/; reference:url,https://fortiguard.fortinet.com/psirt/FG-IR-24-423; content:!"- - - -"; classtype:trojan-activity; sid:5015160; rev:1; metadata:created_at 2024_10_24, updated_at 2024_10_24;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Possible FortiManager Compromise - Modify Device - CVE-2024-47575"; content:"type=event"; content:"subtype=dvm"; content:"adom=|22|root|22|"; nocase; content:"Edited device settings"; nocase; parse_src_ip:1; normalize; reference:url,https://socradar.io/fortimanager-zero-day-fortijump-is-now-publicly-addressed-cve-2024-47575/; reference:url,https://fortiguard.fortinet.com/psirt/FG-IR-24-423; content:!"- - - -"; classtype:trojan-activity; sid:5015161; rev:1; metadata:created_at 2024_10_24, updated_at 2024_10_24;)

alert any any any -> any any (msg: "[FORTINET] DNS Request to Monitored Domain Detected"; content: "type="; content: "subtype="; content: "logid=|22|1501054802|22|"; content: "msg=|22|Domain is monitored|22|"; content: "action=|22|pass|22|"; parse_src_ip: 1; meta_content: "catdesc=|22|%sagan%|22|", Instant Messaging,File Sharing and Storage,Freeware and Software Downloads,Remote Access,Malicious Websites,Proxy Avoidance,Illegal or Unethical,Hacking,Crypto Mining,Child Sexual Abuse,Gambling,Nudity and Risque,Pornography,Peer-to-peer File Sharing,URL Shortening,Potentially Unwanted Program; meta_nocase; content:!"- - - -"; classtype: suspicious-traffic; sid:5015493; rev:3;)

#alert any any any -> any any (msg: "[FORTINET] DNS Request to Monitored Domain Detected"; content: "type="; content: "subtype="; content: "logid=|22|1501054802|22|"; content: "msg=|22|Domain is monitored|22|"; content: "action=|22|pass|22|"; parse_src_ip: 1; content:!"- - - -"; classtype: suspicious-traffic; sid:5015493; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VPN Brute Force for Same User [10/300sec]"; content:"logid=|22|0101039426|22|"; content:"type="; content:"subtype="; normalize; parse_src_ip:1; after:track by_username, count 10, seconds 300; threshold:type suppress,track by_username,count 1,seconds 21600; flexbits:set, brute_force, 21600; reference:url,https://docs.fortinet.com/document/fortigate/7.6.2/fortios-log-message-reference/39426/39426-log-id-event-ssl-vpn-user-ssl-login-fail; content:!"- - - -"; classtype:brute-force; sid:5015828; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VPN Login After Brute Force for Same User"; content:"logid=|22|0101039424|22|"; content:"type="; content:"subtype="; parse_src_ip: 1; normalize; flexbits:isset,username,brute_force; threshold:type suppress,track by_username, count 5, seconds 14400; reference:url,https://docs.fortinet.com/document/fortigate/7.6.2/fortios-log-message-reference/39424/39424-log-id-event-ssl-vpn-user-tunnel-up; content:!"- - - -"; classtype:correlated-attack; sid:5015829; rev:3;)

#===========The below rules are the same as above but take into account a differing log format that has the internal IP of the Fortigate appliance as the first IP address in a log

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] ICMP traffic disallowed"; content: "16003|22| type="; parse_src_ip:2; content:"- - - -"; classtype: not-suspicious; sid:5017220; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Super Administrator Login"; content: "32001|22| type="; content: "logged in"; content:"profile=|22|super_admin|22|"; parse_src_ip:2; content:"- - - -"; classtype: successful-admin; sid:5017221; rev:4;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin login failed"; content: "32002|22| type="; content: "login failed"; parse_src_ip:2; content:"- - - -"; classtype: attempted-admin; sid:5017222; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] To many bad admin login attempts"; content: "32002|22| type="; content: "bad attempts"; parse_src_ip:2; content:"- - - -"; classtype: attempted-admin; sid:5017223; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Multiple Admin Login Failures â€“ Brute Force [25/5]"; content: "32002|22| type="; content: "login failed"; parse_src_ip:2; content:"- - - -"; classtype: brute-force; xbits: set,brute_force, track ip_src, expire 21600; after: track by_src, count 25, seconds 300; threshold: type suppress, track by_src, count 10, seconds 300; sid:5017224; rev:13;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Login accepted"; content: "32006|22| type="; content: "login"; meta_content: "%sagan%",accepted,successfully; parse_src_ip:2; content:"- - - -"; classtype: successful-admin; sid:5017225; rev:4;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Administrator session timeout"; content: "32007|22| type="; content: "session timed out"; parse_src_ip:2; content:"- - - -"; classtype: not-suspicious; sid:5017226; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Abnormal Admin session drop"; content: "32007|22| type="; content: "terminates the sessions"; parse_src_ip:2; content:"- - - -"; classtype: not-suspicious; sid:5017227; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Normal administrator logout"; content: "32007|22| type="; pcre: "/logs out from|is diconnected by/"; parse_src_ip:2;  content:"- - - -"; classtype: not-suspicious; sid:5017228; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin authentication failure"; content: "38002|22| type="; pcre: "/failed to authenticate|failed in authentication/i"; parse_src_ip:2; content:"- - - -"; classtype: attempted-admin; sid:5017229; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Botnet traffic detected"; content: "app_list=|22|BotnetOnly|22| app_type=|22|Botnet|22|"; content:"- - - -"; classtype: trojan-activity; parse_src_ip:2; parse_dst_ip:3; sid:5017230; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSH traffic detected"; content: " service=SSH "; content:"- - - -"; classtype: trojan-activity; parse_src_ip:2; parse_dst_ip:3; sid:5017231; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Compromised Host Detected"; content: "logid=|22|0100022953|22|"; content: "type="; content: "subtype="; content:!"level=|22|warning|22|"; content:"- - - -"; classtype: malware; parse_src_ip:2; sid:5017232; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Successful Admin Login [2]"; content: "logid=|22|0100032001|22|"; content: "jsconsole"; content: "type="; content: "subtype="; threshold: type suppress, track by_src, count 1, seconds 86400; content:"- - - -"; classtype: successful-admin; parse_src_ip:2; parse_dst_ip:3; sid:5017233; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Super admin entered VDOM"; content: "logid=|22|0100032006|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; sid:5017234; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Configuration change"; content: "logid=|22|0100032102|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: configuration-change; parse_src_ip:2; sid:5017235; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Data Leak Prevention Rule Matched"; content: "logid=|22|0954024576|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: policy-violation; parse_src_ip:2; parse_dst_ip:3; sid:5017236; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant messaging message"; content: "logid=|22|1059028672|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: policy-violation; parse_src_ip:2; parse_dst_ip:3; sid:5017237; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message - file tranfer message"; content: "logid=|22|1059028675|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: policy-violation; parse_src_ip:2; parse_dst_ip:3; sid:5017238; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message chat message"; content: "logid=|22|1059028676|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: policy-violation; parse_src_ip:2; parse_dst_ip:3; sid:5017239; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VoIP-SIP session blocked"; content: "logid=|22|0814044033|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: policy-violation; parse_src_ip:2; parse_dst_ip:3; sid:5017240; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Infected File Detected Within Email"; content: "logid=|22|0211008194|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: suspicious-traffic; parse_src_ip:2; parse_dst_ip:3; sid:5017241; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by UDP/TCP Signature"; content: "logid=|22|0419016384|22|"; content: "type="; content: "subtype="; content: !"action=|22|dropped|22|"; meta_content:!"severity=|22|%sagan%|22|",info,low,medium; content:"- - - -"; classtype: misc-attack; parse_src_ip:2; parse_dst_ip:3; sid:5017242; rev:5; metadata: updated_at 2024_07_24;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by ICMP Signature"; content: "logid=|22|0419016385|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: misc-attack; parse_src_ip:2; parse_dst_ip:3; sid:5017243; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by Other Signature"; content: "logid=|22|0419016386|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: misc-attack; parse_src_ip:2; parse_dst_ip:3; sid:5017244; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by Malicious URL"; content: "logid=|22|0421016399|22|"; content: "type="; content: "subtype="; content:!"URL blocked "; content:"- - - -"; classtype: misc-attack; parse_src_ip:2; parse_dst_ip:3; sid:5017245; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Botnet C&C Communication - Warning"; content: "logid=|22|0402016400|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: misc-attack; parse_src_ip:2; parse_dst_ip:3; sid:5017246; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Web - Banned word was found"; content: "logid=|22|0314012288|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: policy-violation; parse_src_ip:2; parse_dst_ip:3; sid:5017247; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Cookie Removed Entirely"; content: "logid=|22|0336013601|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: web-application-activity; parse_src_ip:2; parse_dst_ip:3; sid:5017248; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Cookie Removed"; content: "logid=|22|0336013573|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: web-application-activity; parse_src_ip:2; parse_dst_ip:3; sid:5017249; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Java applet was removed"; content: "logid=|22|0337013584|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: web-application-activity; parse_src_ip:2; parse_dst_ip:3; sid:5017250; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] ActiveX script was removed"; content: "logid=|22|0335013568|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: web-application-activity; parse_src_ip:2; parse_dst_ip:3; sid:5017251; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Script Entity Removed"; content: "logid=|22|0341013600|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: web-application-activity; parse_src_ip:2; parse_dst_ip:3; sid:5017252; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Blocked per Filter"; content: "logid=|22|0315012544|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: policy-violation; parse_src_ip:2; parse_dst_ip:3; sid:5017253; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Exempt per Filter"; content: "logid=|22|0315012545|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: not-suspicious; parse_src_ip:2; parse_dst_ip:3; sid:5017254; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Allowed per Filter"; content: "logid=|22|0315012546|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: not-suspicious; parse_src_ip:2; parse_dst_ip:3; sid:5017255; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Belongs to Blocked Category Within Firewall Policy"; content: "logid=|22|0316013056|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: policy-violation; parse_src_ip:2; parse_dst_ip:3; sid:5017256; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Belongs to Allowed Category Within Firewall Policy"; content: "logid=|22|0317013312|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: not-suspicious; parse_src_ip:2; parse_dst_ip:3; sid:5017257; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  New SSL VPN Connection From Outside HOME_COUNTRY"; content: "logid=|22|0101039943|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; country_code: track by_src, isnot $HOME_COUNTRY; sid:5017258; rev:1;) #Disabled in favor of successful login via VPN from outside home country
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Successful VPN Login From Outside HOME_COUNTRY"; content: "logid=|22|0101039424|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: suspicious-traffic; parse_src_ip:2; country_code: track by_src, isnot $HOME_COUNTRY; sid:5017259; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  SSL Decryption Failed"; content: "logid=|22|0105048009|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-error; parse_src_ip:2; parse_dst_ip:3; sid:5017260; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL VPN Alert"; content: "logid=|22|0101039944|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; sid:5017261; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Fatal Alert Received"; content: "logid=|22|0105048038|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; parse_dst_ip:3; sid:5017262; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Authentication Logon"; content: "logid=|22|0102043039|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; sid:5017263; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Authentication Logout"; content: "logid=|22|0102043040|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; sid:5017264; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Monitor login Successful"; content: "logid=|22|0100032053|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; parse_dst_ip:3; sid:5017265; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Infected File Detected and Blocked"; content: "logid=|22|0211008192|22|"; content: "type="; content: "subtype="; content:!"subject="; pcre:"/srcip=(10\.\d{1,3}\.\d{1,3}\.\d{1,3}|172.([12][0-9]|3[0-2])\.\d{1,3}\.\d{1,3}|192\.168\.\d{1,3}\.\d{1,3})/"; threshold: type suppress, track by_dst, count 1, seconds 14400; content:"- - - -"; classtype: system-event; parse_src_ip:2; parse_dst_ip:3; sid:5017266; rev:5; metadata: updated_on 2025_12_04;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Virus Command Blocked"; content: "logid=|22|0206008452|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; parse_dst_ip:3; sid:5017267; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] App-Control IPS Pass"; content: "logid=|22|1059028704|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; parse_dst_ip:3; sid:5017268; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] App-Control IPS Block"; content: "logid=|22|1059028705|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; parse_dst_ip:3; sid:5017269; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - Blocked"; content: "logid=|22|1700062303|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: suspicious-traffic; parse_src_ip:2; parse_dst_ip:3; sid:5017270; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - Disallow list"; content: "logid=|22|1700062300|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: suspicious-traffic; parse_src_ip:2; parse_dst_ip:3; sid:5017271; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - SNI Mismatched"; content: "logid=|22|1700062304|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: suspicious-traffic; parse_src_ip:2; parse_dst_ip:3; sid:5017272; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] DNS - Domain Belongs to a Denied Category in Policy"; content: "logid=|22|1501054803|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: suspicious-traffic; parse_src_ip:2; parse_dst_ip:3; sid:5017273; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Web Filter Rating Error Occurred"; content: "logid=|22|0318012800|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-error; parse_src_ip:2; parse_dst_ip:3; sid:5017274; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by UDP/TCP Anomaly"; content: "logid=|22|0720018432|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: misc-attack; parse_src_ip:2; parse_dst_ip:3; sid:5017275; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by ICMP Anomaly"; content: "logid=|22|0720018433|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: misc-attack; parse_src_ip:2; parse_dst_ip:3; sid:5017276; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by Other Anomaly"; content: "logid=|22|0720018434|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: misc-attack; parse_src_ip:2; parse_dst_ip:3; sid:5017277; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Login Disabled"; content: "logid=|22|0100032021|22|"; content: "type="; content: "subtype="; content:"- - - -"; classtype: system-event; parse_src_ip:2; parse_dst_ip:3; sid:5017278; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Login Failed via VPN - Brute Force [10/5]"; content: "logid=|22|0101039426|22|"; content: "type="; content: "subtype="; parse_src_ip:2; normalize; after: track by_src&by_username, count 10, seconds 300; flexbits: set, brute_force, 21600; threshold: type suppress, track by_src, count 1, seconds 21600; content:"- - - -"; classtype: brute-force; sid:5017279; rev:5;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VPN Login After Brute Force "; content: "logid=|22|0101039424|22|"; content: "type="; content: "subtype="; normalize; parse_src_ip:2; flexbits: isset, by_src, brute_force; flexbits: isset, username, brute_force; threshold: type suppress, track by_src&by_username, count 1, seconds 3600; content:"- - - -"; classtype: correlated-attack; sid:5017280; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[FORTINET] Administrator Login from External IP address"; content:"32001|22| type="; content:"logged in"; parse_src_ip:2; pcre:"/from\s\w+\((\d+)(?<!10)\.(\d+)(?<!192\.168)(?<!172\.(1[6-9]|2\d|3[0-1]))\.(\d+)\.(\d+)/"; content:"- - - -"; classtype:successful-admin; sid:5017281; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM Multiple Webfilter Events Detect from a Single Source [250/1]"; content:" type=|22|utm|22|"; content:" subtype=|22|webfilter|22|"; meta_content:"catdesc=|22|%sagan%",File|20|Sharing|20|and|20|Storage,Remote|20|Access,Child|20|Sexual|20|Abuse,Crypto|20|Mining,Hacking,Terrorism,Potentially|20|Unwanted|20|Program,Dynamic|20|DNS,Malicious|20|Websites,Newly|20|Observed|20|Domain,Newly|20|Registered|20|Domain,Phishing,Spam|20|URLs,Unrated,Not|20|Rated; meta_content:!"catdesc=|22|%sagan%",Advertising,Freeware,Meaningless,File|20|Sharing,Instant|20|Messaging; pcre:"/srcip=(?:(10\.|172\.(1[6-9]|2[0-9]|3[0-1])\.|192\.168\.))\d{1,3}\.\d{1,3}\.\d{1,3}/"; pcre:"/dstip=(?!(10\.|172\.(1[6-9]|2[0-9]|3[0-1])\.|192\.168\.))\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/"; meta_content:!"eventtype=|22|%sagan%|22|",ftgd_allow; meta_content:!"crlevel|22 3a||22|%sagan%|22|",low,medium; content:!"severity|22 3a|low"; meta_content:!"level|22 3a||22|%sagan%|22|",notice,information; content:!".tiktokv.com"; content:!".tiktokcdn-us.com"; content:!"Microsoft-WebDAV-MiniRedir"; content: !"Microsoft-Delivery-Optimization"; meta_content: !"%sagan%",|2e|gov,|2e|edu|2e|local,collector|2e|azure|2e|microsoft|2e|scloud; content:!".live.net"; content:!"oneclient.sfx.ms"; content:!".delivery.mp.microsoft.com"; content:!"icloud.com"; after:track by_src,count 250, seconds 7200; threshold:type suppress, track by_src, count 1, seconds 86400; parse_src_ip:2; parse_dst_ip:3; normalize; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017282; rev:5; metadata:updated_at 2024_06_05;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM ips Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|ips|22|"; meta_content:!"severity=|22|%sagan%|22|",low,info; content:!"level=|22|notice|22|"; content:!"crlevel=|22|low|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017283; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM emailfilter Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|emailfilter|22|"; content:!"severity=low"; meta_content:!"level=|22|%sagan%|22|",notice,information; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017284; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM Anomaly Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|anomaly|22|"; content:"severity=critical"; content:!"level=|22|notice|22|"; content:!"policytype=|22|DoS-policy|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017285; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM voip Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|voip|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; content:"- - - -"; classtype:system-event; parse_src_ip:2; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017286; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM dlp Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|dlp|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017287; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM app-ctl Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|app-ctl|22|"; content:!"severity=low"; meta_content:!"level=|22|%sagan%|22|",information,notice; meta_content:!"apprisk=|22|%sagan%|22|",low,medium; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017288; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM WAF Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|waf|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017289; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM WAF Custom Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|waf|22|"; content:"eventtype=waf-custom-signature"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017290; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM gtp Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|gtp|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017291; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM dns Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|dns|22|"; meta_content:"catdesc=|22|%sagan%",File|20|Sharing|20|and|20|Storage,Remote|20|Access,Child|20|Sexual|20|Abuse,Crypto|20|Mining,Hacking,Terrorism,Dynamic|20|DNS,Malicious|20|Websites,Newly|20|Registered|20|Domain,Phishing,Unrated,Not|20|Rated; content:!"action=|22|redirect|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; content:!".live.net"; content:!"oneclient.sfx.ms"; content:!".delivery.mp.microsoft.com"; content:!"icloud.com"; meta_content:!"%sagan%",|2e|local,|2e|internal,wpad|2e|; parse_src_ip:2; parse_dst_ip:3; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; reference:url,https://community.fortinet.com/t5/FortiGate/Troubleshooting-Tip-DNS-Filter-profile-Redirect-to-Fortinet/ta-p/227243; sid:5017292; rev:4; metadata:updated_at 2024_05_16;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM ssh Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|ssh|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017293; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM ssl Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|ssl|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017294; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM file-filter Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|file-filter|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; content:!"hostname=|22|adl.windows.com|22|"; content:!".windowsupdate.com|22|"; content:!"hostname=|22|edgedl.me.gvt1.com|22|"; meta_content: !"%sagan%", Microsoft-WebDAV-MiniRedir,Microsoft-Delivery-Optimization; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017295; rev:2; metadata: updated_on 2024_06_05;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM icap Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|icap|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017296; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM forti-switch Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|forti-switch|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017297; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM virtual-patch Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|virtual-patch|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017298; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM casb Event Detected"; content:" type=|22|utm|22|"; content:" subtype=|22|casb|22|"; content:!"severity=low"; content:!"level=|22|notice|22|"; parse_src_ip:2; content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017299; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Botnet Communication Detected"; content:"trigger=Default-Botnet-Communication-Detection-By-"; meta_content:!"action=|22|%sagan%|22|",dropped,blocked; parse_src_ip:2; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; content:"- - - -"; classtype:trojan-activity; sid:5017300; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Botnet Communication Detected - Direction Outgoing"; content:"trigger=Default-Botnet-Communication-Detection-By-"; content:"direction=|22|outgoing|22|"; pcre:"/srcip=(10(\.(1?\d\d?|2([0-4]\d?|5[0-5])))(?2)|172\.(1[6-9]|2\d|3[0-2])(?2)|192\.168(?2))(?2)/"; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:2; content:"- - - -"; classtype:trojan-activity; sid:5017301; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Compromised Host Detected"; content:"trigger=Default-Compromised Host-Detection-IOC-By-"; content:!"type=|22|traffic|22|"; meta_content:!" level=|22|%sagan%|22|",warning,notice; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:2; content:"- - - -"; classtype:trojan-activity; sid:5017302; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Sandbox Detections Event"; content:"trigger=Default-Sandbox-Detections-By-"; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:2; content:"- - - -"; classtype:trojan-activity; sid:5017303; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Malicious File Detected"; content:"trigger=Default-Malicious-File-Detection-By-"; content:!"action=|22|blocked|22|"; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:2; content:"- - - -"; classtype:trojan-activity; sid:5017304; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Malicious File Detected - Direction Outgoing"; content:"trigger=Default-Malicious-File-Detection-By-"; content:"direction=|22|outgoing|22|"; content:!"subject="; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:2; content:"- - - -"; classtype:trojan-activity; sid:5017305; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Risky Destination Detected [100/1]"; content:"trigger=Default-Risky-Destination-Detection-By-"; content:!"eventtype=|22|ftgd_allow|22|"; after:track by_src&by_dst,count 100,seconds 7200; threshold:type suppress,track by_src&by_dst,count 1, seconds 86400; parse_src_ip:2; parse_dst_ip:3; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:2; content:"- - - -"; classtype:trojan-activity; sid:5017306; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Risky Application Detected"; content:"trigger=Default-Risky-App-Detection-By-"; content:!"msg=|22|Proxy: Proxy.HTTP|22|"; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/ef4bde1e-412e-11ee-8e6d-fa163e15d75b/FortiAnalyzer-7.4.1-Administration_Guide.pdf; parse_src_ip:2; content:"- - - -"; classtype:trojan-activity; sid:5017307; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM dns Event Detected - Possible C2 Traffic [250/1]"; content:" type=|22|utm|22|"; content:" subtype=|22|dns|22|"; meta_content:"catdesc=|22|%sagan%",File|20|Sharing|20|and|20|Storage,Remote|20|Access,Child|20|Sexual|20|Abuse,Crypto|20|Mining,Hacking,Terrorism,Potentially|20|Unwanted|20|Program,Dynamic|20|DNS,Malicious|20|Websites,Newly|20|Observed|20|Domain,Newly|20|Registered|20|Domain,Phishing,Spam|20|URLs,Unrated,Not|20|Rated; content:!"severity=low"; content:!"level=|22|notice|22|"; content:!".live.net"; content:!"oneclient.sfx.ms"; content:!".delivery.mp.microsoft.com"; content:!"icloud.com"; meta_content:!"%sagan%",|2e|local,|2e|internal,wpad|2e|; parse_src_ip:2; parse_dst_ip:3; after:track by_src,count 250, seconds 7200; threshold:type suppress, track by_src, count 1, seconds 86400 content:"- - - -"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5017308; rev:1; metadata:updated_at 2024_05_16;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Possible FortiManager Compromise - Unregistered Device - CVE-2024-47575"; content:"type=event"; content:"subtype=dvm"; content:"Unregistered device"; nocase; content:"add succeeded"; nocase; parse_src_ip:2; normalize; reference:url,https://socradar.io/fortimanager-zero-day-fortijump-is-now-publicly-addressed-cve-2024-47575/; reference:url,https://fortiguard.fortinet.com/psirt/FG-IR-24-423; content:"- - - -"; classtype:trojan-activity; sid:5017309; rev:1; metadata:created_at 2024_10_24, updated_at 2024_10_24;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Possible FortiManager Compromise - Modify Device - CVE-2024-47575"; content:"type=event"; content:"subtype=dvm"; content:"adom=|22|root|22|"; nocase; content:"Edited device settings"; nocase; parse_src_ip:2; normalize; reference:url,https://socradar.io/fortimanager-zero-day-fortijump-is-now-publicly-addressed-cve-2024-47575/; reference:url,https://fortiguard.fortinet.com/psirt/FG-IR-24-423; content:"- - - -"; classtype:trojan-activity; sid:5017310; rev:1; metadata:created_at 2024_10_24, updated_at 2024_10_24;)
alert any any any -> any any (msg: "[FORTINET] DNS Request to Monitored Domain Detected"; content: "type="; content: "subtype="; content: "logid=|22|1501054802|22|"; content: "msg=|22|Domain is monitored|22|"; content: "action=|22|pass|22|"; parse_src_ip:2; meta_content: "catdesc=|22|%sagan%|22|", Instant Messaging,File Sharing and Storage,Freeware and Software Downloads,Remote Access,Malicious Websites,Proxy Avoidance,Illegal or Unethical,Hacking,Crypto Mining,Child Sexual Abuse,Gambling,Nudity and Risque,Pornography,Peer-to-peer File Sharing,URL Shortening,Potentially Unwanted Program; meta_nocase; content:"- - - -"; classtype: suspicious-traffic; sid:5017311; rev:3;)
#alert any any any -> any any (msg: "[FORTINET] DNS Request to Monitored Domain Detected"; content: "type="; content: "subtype="; content: "logid=|22|1501054802|22|"; content: "msg=|22|Domain is monitored|22|"; content: "action=|22|pass|22|"; parse_src_ip:2; content:"- - - -"; classtype: suspicious-traffic; sid:5017312; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VPN Brute Force for Same User [10/300sec]"; content:"logid=|22|0101039426|22|"; content:"type="; content:"subtype="; normalize; parse_src_ip:2; after:track by_username, count 10, seconds 300; threshold:type suppress,track by_username,count 1,seconds 21600; flexbits:set, brute_force, 21600; reference:url,https://docs.fortinet.com/document/fortigate/7.6.2/fortios-log-message-reference/39426/39426-log-id-event-ssl-vpn-user-ssl-login-fail; content:"- - - -"; classtype:brute-force; sid:5017313; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VPN Login After Brute Force for Same User"; content:"logid=|22|0101039424|22|"; content:"type="; content:"subtype="; parse_src_ip:2; normalize; flexbits:isset,username,brute_force; threshold:type suppress,track by_username, count 5, seconds 14400; reference:url,https://docs.fortinet.com/document/fortigate/7.6.2/fortios-log-message-reference/39424/39424-log-id-event-ssl-vpn-user-tunnel-up; content:"- - - -"; classtype:correlated-attack; sid:5017314; rev:3;)
#===========================================================
