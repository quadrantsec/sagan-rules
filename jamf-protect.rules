# Sagan jamf-protect.rules
# Copyright (c) 2009-2023. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************

# rules by "Bryant Smith" <bsmith@quadrantsec.com>
# 02/27/2024
#References
#https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html
#https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html
#https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html
#https://learn.jamf.com/bundle/jamf-protect-documentation/page/Built-in_Analytics.html
#https://learn.jamf.com/bundle/jamf-protect-documentation/page/Alerts_and_Logs_Dictionary.html


#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events add to group"; program:jamf_protect; json_content:".header.event_name","AUE_add_to_group"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014228; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events AUDITCTL"; program:jamf_protect; json_content:".header.event_name","AUE_AUDITCTL"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014229; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events AUDITON SPOLICY"; program:jamf_protect; json_content:".header.event_name","AUE_AUDITON_SPOLICY"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014230; rev:1;)

alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events auth user - Brute Force [10/300sec]"; program:jamf_protect; json_content:".header.event_name","AUE_auth_user"; json_content:!".return.error","0"; json_map:"username",".subject.effective_user_name"; after:track by_username, count 10, seconds 300; threshold:type suppress,track by_username, count 1, seconds 86400; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014231; rev:2;)

#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events BIND"; program:jamf_protect; json_content:".header.event_name","AUE_BIND"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014232; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events BIOS FIRMWARE VERSIONS"; program:jamf_protect; json_content:".header.event_name","AUE_BIOS_FIRMWARE_VERSIONS"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014233; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events CHROOT"; program:jamf_protect; json_content:".header.event_name","AUE_CHROOT"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014234; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events CONNECT"; program:jamf_protect; json_content:".header.event_name","AUE_CONNECT"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014235; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events create group"; program:jamf_protect; json_content:".header.event_name","AUE_create_group"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014236; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events create user"; program:jamf_protect; json_content:".header.event_name","AUE_create_user"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014237; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events delete user"; program:jamf_protect; json_content:".header.event_name","AUE_delete_user"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014238; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events EXECVE"; program:jamf_protect; json_content:".header.event_name","AUE_EXECVE"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014239; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events FORK"; program:jamf_protect; json_content:".header.event_name","AUE_FORK"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014240; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events GETAUID"; program:jamf_protect; json_content:".header.event_name","AUE_GETAUID"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014241; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events LISTEN"; program:jamf_protect; json_content:".header.event_name","AUE_LISTEN"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014242; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events logout"; program:jamf_protect; json_content:".header.event_name","AUE_logout"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014243; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events lw login failed"; program:jamf_protect; json_content:".header.event_name","AUE_lw_login"; json_content:!".return.error","0"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014244; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events MAC SET PROC"; program:jamf_protect; json_content:".header.event_name","AUE_MAC_SET_PROC"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014245; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events modify group"; program:jamf_protect; json_content:".header.event_name","AUE_modify_group"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014246; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events modify password"; program:jamf_protect; json_content:".header.event_name","AUE_modify_password"; json_content:!".subject.user_name","root"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014247; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events modify user"; program:jamf_protect; json_content:".header.event_name","AUE_modify_user"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014248; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events mount"; program:jamf_protect; json_content:".header.event_name","AUE_mount"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014249; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events openssh"; program:jamf_protect; json_content:".header.event_name","AUE_openssh"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014250; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events POSIX SPAWN"; program:jamf_protect; json_content:".header.event_name","AUE_POSIX_SPAWN"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014251; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events PTRACE"; program:jamf_protect; json_content:".header.event_name","AUE_PTRACE"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014252; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events remove from group"; program:jamf_protect; json_content:".header.event_name","AUE_remove_from_group"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014253; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events SESSION CLOSE"; program:jamf_protect; json_content:".header.event_name","AUE_SESSION_CLOSE"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014254; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events SESSION END"; program:jamf_protect; json_content:".header.event_name","AUE_SESSION_END"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014255; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events SESSION START"; program:jamf_protect; json_content:".header.event_name","AUE_SESSION_START"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014256; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events SESSION UPDATE"; program:jamf_protect; json_content:".header.event_name","AUE_SESSION_UPDATE"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014257; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events SETTIMEOFDAY"; program:jamf_protect; json_content:".header.event_name","AUE_SETTIMEOFDAY"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014258; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events SHUTDOWN"; program:jamf_protect; json_content:".header.event_name","AUE_SHUTDOWN"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014259; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events ssauthint"; program:jamf_protect; json_content:".header.event_name","AUE_ssauthint"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014260; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events ssauthmech"; program:jamf_protect; json_content:".header.event_name","AUE_ssauthmech"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014261; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events ssauthorize failed"; program:jamf_protect; json_content:".header.event_name","AUE_ssauthorize"; json_content:!".return.error","0"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014262; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Audit User Events UNMOUNT"; program:jamf_protect; json_content:".header.event_name","AUE_UNMOUNT"; classtype:system-event; reference:url,https://learn.jamf.com/bundle/compliance-reporter-documentation/page/Audit_User_Events_Log_Data.html; sid:5014263; rev:1;)


#GPFSEvent
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] File System Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPFSEvent"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014264; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] File System Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPFSEvent"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014265; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] File System Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPFSEvent"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014266; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] File System Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPFSEvent"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014267; rev:1;)
#GPProcessEvent
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Process Monitoring Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPProcessEvent"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014268; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Process Monitoring Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPProcessEvent"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014269; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Process Monitoring Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPProcessEvent"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014270; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Process Monitoring Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPProcessEvent"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014271; rev:1;)
#GPSyntheticClickEvent
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Synthetic Mouse Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPSyntheticClickEvent"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014272; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Synthetic Mouse Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPSyntheticClickEvent"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014273; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Synthetic Mouse Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPSyntheticClickEvent"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014274; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Synthetic Mouse Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPSyntheticClickEvent"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014275; rev:1;)
#GPUSBEvent
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] USB Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPUSBEvent"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014276; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] USB Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPUSBEvent"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014277; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] USB Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPUSBEvent"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014278; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] USB Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPUSBEvent"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014279; rev:1;)
#GPDownloadEvents
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] File Download Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPDownloadEvents"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014280; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] File Download Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPDownloadEvents"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014281; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] File Download Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPDownloadEvents"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014282; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] File Download Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPDownloadEvents"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014283; rev:1;)
#MRT
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Malware Removal Tool Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPMRTEvent"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014284; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Malware Removal Tool Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPMRTEvent"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014285; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Malware Removal Tool Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPMRTEvent"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014286; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Malware Removal Tool Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPMRTEvent"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014287; rev:1;)
#Gatekeeper
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Gatekeeper Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPGatekeeperEvent"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014288; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Gatekeeper Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPGatekeeperEvent"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014289; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Gatekeeper Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPGatekeeperEvent"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014290; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Gatekeeper Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPGatekeeperEvent"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014291; rev:1;)
#Keylog
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Keylog Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPKeylogRegisterEvent"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014292; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Keylog Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPKeylogRegisterEvent"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014293; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Keylog Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPKeylogRegisterEvent"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014294; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Keylog Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPKeylogRegisterEvent"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014295; rev:1;)
#GPPreventedExecutionEvent
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Execution Prevention Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPPreventedExecutionEvent"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014296; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Execution Prevention Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPPreventedExecutionEvent"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014297; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Execution Prevention Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPPreventedExecutionEvent"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014298; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Execution Prevention Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPPreventedExecutionEvent"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014299; rev:1;)
#GPThreatMatchExecEvent
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Threat Match Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPThreatMatchExecEvent"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014300; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Threat Match Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPThreatMatchExecEvent"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014301; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Threat Match Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPThreatMatchExecEvent"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014302; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Threat Match Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPThreatMatchExecEvent"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014303; rev:1;)
#GPUnifiedLogEvent
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Unified Log Event Detected (informational)"; program:jamf_protect; json_content:".input.eventType","GPUnifiedLogEvent"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014304; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Unified Log Event Detected (low)"; program:jamf_protect; json_content:".input.eventType","GPUnifiedLogEvent"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014305; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Unified Log Event Detected (medium)"; program:jamf_protect; json_content:".input.eventType","GPUnifiedLogEvent"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014306; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Unified Log Event Detected (high)"; program:jamf_protect; json_content:".input.eventType","GPUnifiedLogEvent"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014307; rev:1;)
#Custom Events
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Custom Event Detected (informational)"; program:jamf_protect; json_content:".input.match.custom","true"; json_content:".input.match.severity","0"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014308; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Custom Event Detected (low)"; program:jamf_protect; json_content:".input.match.custom","true"; json_content:".input.match.severity","1"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014309; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Custom Event Detected (medium)"; program:jamf_protect; json_content:".input.match.custom","true"; json_content:".input.match.severity","2"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014310; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[JAMF-PROTECT] Custom Event Detected (high)"; program:jamf_protect; json_content:".input.match.custom","true"; json_content:".input.match.severity","3"; parse_src_ip:1; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Analytic_Descriptions.html; reference:url,https://learn.jamf.com/bundle/jamf-protect-documentation/page/Telemetry_Log_Data_Examples.html; classtype:trojan-activity; sid:5014311; rev:1;)
